# Modify/rename @resource(s)

## question 
Hi TypeSpec Discussion,
 
I have two swaggers, we'll call it 2021 and 2023 - both are GA'd versions. 2023 (originally generated by swashbuckle) has been successfully migrated to typespec. 2021 not yet migrated to typespec.
 
The difference between 2023 and 2021 is basically the grouping of a few apis as 'authoring' (left is 2023, right is 2021)
```diff
  "description": "Error response.",
  "schema": {
    "$ref": "common.json#/definitions/ErrorResponse"
  }
 }
},
"x-ms-examples": {
  "Successful query": {
    "$ref": "./examples/questionanswering/authoring/SuccessfulProjectsListProjects.json"
  }
 }
 }
},
-"/authoring/query-knowledgebases/projects/{projectName}": {
+"/query-knowledgebases/projects/{projectName}": {
  "get": {
    "summary": "Get the requested project metadata.",
    "operationId": "QuestionAnsweringProjects_GetProjectDetails",
    "parameters": [
      {
        "$ref": "common.json#/parameters/ProjectNamePathParameter"
      },
      {
        "$ref": "common.json#/parameters/ApiVersionParameter"
      }
    ],
```
What would be the appropriate way to go about representing 2021 in typespec?
 
P.S. 2023 is the current GA version.
Reference:
2023: [azure-rest-api-specs/specification/cognitiveservices/data-plane/Language/stable/2023-04-01/questionanswering-authoring.json at main ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/blob/main/specification/cognitiveservices/data-plane/Language/stable/2023-04-01/questionanswering-authoring.json)
2021: [azure-rest-api-specs/specification/cognitiveservices/data-plane/Language/stable/2021-10-01/questionanswering-authoring.json at main ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/blob/main/specification/cognitiveservices/data-plane/Language/stable/2021-10-01/questionanswering-authoring.json)

## answer
This would be a big breaking change, which means you should talk to the breaking change board first.  In typespec,  you would need to have separate operations (one in the group one out of the group),  with @added and @removed decorators marking when the APIs were introduced and when they were discontinued

# pageItems

## question 
Hi TypeSpec Discussion, I was doing some changes in my typespec and I got some unrelated errors when I try to compile
```
TypeSpec compiler v1.0.0

√ó Compiling
Diagnostics were reported during compilation:

../D:/repos/azure-rest-api-specs-pr/specification/computeschedule/ComputeSchedule.Management/routes.tsp:113:3 - error missing-paging-items: Paged operation 'listResources' return type must have a property annotated with @pageItems.
> 113 |   listResources(
      |   ^^^^^^^^^^^^^
../D:/repos/azure-rest-api-specs-pr/specification/computeschedule/ComputeSchedule.Management/occurrenceroutes.tsp:26:3 - error missing-paging-items: Paged operation 'listResources' return type must have a property annotated with @pageItems.
> 26 |   listResources is ArmResourceActionSync<
     |   ^^^^^^^^^^^^^
../D:/repos/azure-rest-api-specs-pr/specification/computeschedule/ComputeSchedule.Management/occurrenceroutes.tsp:51:3 - error missing-paging-items: Paged operation 'listResources' return type must have a property annotated with @pageItems.
> 51 |   listResources(
     |   ^^^^^^^^^^^^^
../D:/repos/azure-rest-api-specs-pr/specification/computeschedule/ComputeSchedule.Management/autoactionroutes.tsp:31:3 - error missing-paging-items: Paged operation 'listResources' return type must have a property annotated with @pageItems.
> 31 |   listResources is ArmResourceActionSync<
     |   ^^^^^^^^^^^^^

Found 4 errors.
```
Nothing for those operations was modified. The op returns the following type
```
@@identifiers(ResourceListResponse.value, #[]);
@added(Microsoft.ComputeSchedule.Versions.`2025-04-15-preview`)
model ResourceListResponse is Azure.Core.Page<ScheduledActionResource>;
```
because it comes from Azure typespec, I cannot add the @pageItems annotation to the value property. 
 
Can you help me unblock. Our team cannot do any typespec changes until this is fixed. 

## answer
The version of your spec in main should be valid. Can you create a draft PR showing the error?  What branch are you starting from?
From your log, I see TSP compiler 1.0, which is outdated.  You should use the TSP package versions specified in the root package.json in the specs repo.
 
Update your local clone (and remote branch if needed), then run "npm ci" from repo root to install latest packages.

# Paged Operation list return type

## question 
Hello,
I'm seeing a new error I've never seen before when trying to compile my TypeSpec:
```
/**
 * Lists all pending remote connections that are linkable to this connection.
 */

Error message:
Paged operation 'list' return type must have a property annotated with @pageItems.
TypeSpec(missing-paging-items)
Loading...
View Problem (Alt+F8) No quick fixes available

list is ArmResourceActionSync<
    Connection,
    void,
    ArmResponse<ResourceListCustomResult<PendingConnection>>
>;
```
This is the first time I have encountered this error. This has never appeared before and I've even merged a PR with this change.

Here is the error detail:
 
Paged operation 'list' return type must have a property annotated with @pageItems

## answer
This is related to a change in how list operations are encoded - this was fixed in all checked-in specs.  If you haven't added any new custom list operations with custom return types , then just pulling the latest, re-installing dependencies and re-compiling should fix the issue

# Looking for someone to suppress CI failures https://github.com/Azure/azure-rest-api-specs/pull/36221

## question 
Hi I'm looking for someone to help suppress CI Failure on this PR [new addProxyAgentExtension property for proxyagentsettings by huiminyan2017 ¬∑ Pull Request #36221 ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/pull/36221)
 
Compute has multiple API versions so the Avacado check failure is expected.

## answer
Your PR is to a feature branch, so no checks are required.
 
However, your PR may be blocked when you try to merge to main, so I recommend following the instructions here now:
 
https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado#multiple_api_version
```
MULTIPLE_API_VERSION
Rule MULTIPLE_API_VERSION was changed from a warning to an error on 7/1/2025. As this issue is a blocker to TypeSpec conversion which is an Azure wide effort to drive the API first design pattern among all Azure services.

If your PR is blocked due to this error, please check out this Uniform Versioning Violation Guide wiki on how to resolve this.

Please check with azversioning@service.microsoft.com to see if your service can have one-time suppression if you are not sure.
```

# Builds failing, assistance requested

## question 
I am trying to update some example files in the rest-api-specs-pr repo: [Update AvailabilitySet_StartMigrationToVirtualMachineScaleSet.json by mimckitt ¬∑ Pull Request #24000 ¬∑ Azure/azure-rest-api-specs-pr](https://github.com/Azure/azure-rest-api-specs-pr/pull/24000)
```
ANNOTATIONS

‚ùå Check failure on line 16 in Build log
üåê azure-pipelines / private.rest-api-specs-pr
Build log #L16
Bash wrote one or more lines to the standard error stream.

‚ùå Check failure on line 17 in Build log
üåê azure-pipelines / private.rest-api-specs-pr
Build log #L17
the branch is protected

üîó View more details on Azure Pipelines
```
Errors are not super informative and I am just updating example files, not any code related files. 

## answer
Looking at the PR, it appears you are updating example files in typespec,  this will impact the example files in the generated swagger, so you must compile the typespec to have the new examples copied over into the swagger examples directory.
 
It also looks to me like the value for 'virtualMachineScaleSetFlexible' is likely invalid, as it changed from an object to a string.
 
Finally, this PR is against the main branch in the private repo,  where no check-ins are allowed.  Is this just for a review, or did you want to check this change in someplace?

# URL Data type breaking for wss url in example

## question 
Hi TypeSpec Discussion,
We had this [existing API Spec](https://github.com/Azure/azure-rest-api-specs/blob/9a583ee95fe0bcb0e0d7e864bf2fba5e75c8ded7/specification/playwrighttesting/PlaywrightTesting.AuthManager/main.tsp#L163) 
```
  location: url;
```
in playwrighttesting earlier and another [preview api-version](https://github.com/Azure/azure-rest-api-specs/blob/9a583ee95fe0bcb0e0d7e864bf2fba5e75c8ded7/specification/loadtestservice/Playwright/routes.tsp#L60) 
```
  location: url;
```
released in loadtestservice after migration, with location as url data type and wss url (required for business logic and already approved by board in earlier reviews) in examples which was working fine until recently when we're creating stable api-version of the same spec in this PR - [Dp malt mpt integration stable by mjmadhu ¬∑ Pull Request #36518 ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/pull/36518). Have we added some constraint recently? If yes, is there a way to help get past breaking change failure due to this except for work-around of changing data type as string?

## answer
The BreakingChanges checks are crashing, because autorest validates examples against a schema that only allows HTTP URLs.  This schema hasn't changed in years, and this is the first case I'm aware of where an example wants to use a non-HTTP URL.
 
Example:

```
  "responses": {
    "302": {
      "headers": {
        "location": "wss://{region}.api.playwright.microsoft.com/redirectURL?api-version=2025-09-01&os=Linux"
      }
    }
  }
```
https://github.com/Azure/azure-rest-api-specs/pull/36518/files#diff-061024acb4148a0e25c02d8bcf09a35e0aa7f30da225d0127dc85d01fe4bc306R9-R15
```
  "responses": {
    "302": {
      "headers": {
        "location": "wss://{region}.api.playwright.microsoft.com/redirectURL?api-version=2025-09-01&os=Linux"
      }
    }
  }
```
Schema:
```
  "xmsResponseHeaderExample": {
    "type": "object",
    "description": "Examples of response headers. Common response headers like 'location', 'azure-asyncoperation', 'retry-after', etc. are defined as optional properties for ease of use. Please feel free to add other response headers as applicable in the example.",
    "properties": {
      "location": {
        "type": "string",
        "description": "An example of the location header sent by the server, if applicable in the example.",
        "minLength": 10,
        "pattern": "^(http|https)://.*"
      },
```
https://github.com/Azure/autorest/blob/eff08c8d76c27f2dba395744f251ef16d7bde7bd/schema/example-schema.json#L72
```
"pattern": "^(http|https)://.*"
```
Options:
1. Change examples (and perhaps your service as well) to return HTTP rather than WSS URLs
2. Update autorest example schema to allow WSS URLs

`Have we added some constraint recently?`
No, the example schema hasn't changed in years.  Some check should have failed on your first PR to introduce an example with the WSS schema.  However, some of our checks (like Breaking Changes) have gaps, where they don't validate anything until the second version of your spec.