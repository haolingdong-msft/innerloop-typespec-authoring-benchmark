# Best way to model a DaysOfWeek Enum/Union?

**Category: Decorators**

## question 
Should I use an enum/closed union or an open union for modelling this? Obviously we never expect to add future values. 
 
Example
```
union DayOfWeek {
  @doc("Monday")
  Monday: "Monday",

  @doc("Tuesday")
  Tuesday: "Tuesday",

  @doc("Wednesday")
  Wednesday: "Wednesday",

  @doc("Thursday")
  Thursday: "Thursday",

  @doc("Friday")
  Friday: "Friday",

  @doc("Saturday")
  Saturday: "Saturday",

  @doc("Sunday")
  Sunday: "Sunday",
}
```

## answer
I believe that would be a case where the closed union/enum would get approved.
Side note use doc comments /** */ as a preferred way to do documentation

# Swagger breaking change

**Category: TypeSpec Migration**

## question 
PR check run: https://github.com/Azure/azure-rest-api-specs/pull/35346/checks?check_run_id=44501918225
My typespec conversion PR is failing in swagger breaking change check with the following error:
 
"new":"https://github.com/Azure/azure-rest-api-specs/blob/a1ac3f6f98bb1ea3583b765d00dfceab6d85654f/specification/devtestlabs/resource-manager/Microsoft.DevTestLab/stable/2018-09-15/DTL.json",
"old":"https://github.com/Azure/azure-rest-api-specs/blob/main/specification/devtestlabs/resource-manager/Microsoft.DevTestLab/stable/2018-09-15/DTL.json",
"details":"incompatible properties : tags\n definitions/TrackedResource/properties/tags\n at file:///mnt/vss/_work/1/azure-rest-api-specs/specification/common-types/resource-management/v3/types.json#L489:8\n definitions/Resource/properties/tags\n at file:///mnt/vss/_work/1/azure-rest-api-specs/specification/devtestlabs/resource-manager/Microsoft.DevTestLab/stable/2018-09-15/DTL.json#L12397:8"
 
This PR is just having typespec conversion change and I am avoiding any change to the swagger file that is generated as part of typespec conversion. In the old swagger there is a Resource definitionwhich is similar Azure resource definition. Should I suppress this check and how to do it? 

## answer
This occurs because in your original swagger, you did not use swagger common-types.
 
The 'tags' definitions are compatible, so there is no change in the actual api from this.  This could result in changes in some management sdks, although this change to using the common resource types has generally been accepted.
 
docs on suppressions for false positives are here: [Suppress validation failures on a PR](https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions)
 
Note that it is important to go through these violations, as the conversion is not guaranteed to be 100% accurate.

# How to change the model to accommodate new decorators for validations

**Category: Versioning**

## question 
My initial model was:
```
model StorageDiscoveryWorkspace
  is Azure.ResourceManager.TrackedResource<StorageDiscoveryWorkspaceProperties> {
  ...ResourceNameParameter<
    Resource = StorageDiscoveryWorkspace,
    KeyName = "storageDiscoveryWorkspaceName",
    SegmentName = "storageDiscoveryWorkspaces",
    NamePattern = "^[a-z0-9]{3,18}$"
  >;
}
```
I want to add different name patterns and min and max length decorators to it. Can I do this instead to replace this with:
```
/**
 * Legacy name type for StorageDiscoveryWorkspace in older API versions (2024-12-01 through 2025-04-01)
 */
@pattern("^[a-z0-9]{3,18}$")
scalar StorageDiscoveryWorkspaceNameLegacy extends string;

/**
 * A Storage Discovery Workspace resource. This resource configures the collection of storage account metrics.
 */
@doc("A Storage Discovery Workspace resource. This resource configures the collection of storage account metrics.")
model StorageDiscoveryWorkspace
  is Azure.ResourceManager.TrackedResource<StorageDiscoveryWorkspaceProperties> {
  
  @doc("The name of the StorageDiscoveryWorkspace")
  @key("storageDiscoveryWorkspaceName")
  @segment("storageDiscoveryWorkspaces")
  @path
  @visibility(Lifecycle.Read)
  // Starting from v2025_06_01_preview, use enhanced validation
  @typeChangedFrom(ApiVersion.v2025_06_01_preview, StorageDiscoveryWorkspaceNameLegacy)
  @pattern("^[a-zA-Z][a-zA-Z0-9]*(-[a-zA-Z0-9]+)*$")
  @minLength(4)
  @maxLength(64)
  name: string;
}
```

## answer
Yes, the service enforces the same validation rules across all API versions. Although this change technically modifies the validation (such as updating the regex and length constraints), the service behavior is consistent across versions. Therefore, it's appropriate to apply the updated validation pattern universally, rather than scoping it to a specific API version.

This change is not breaking for SDKs since there is no client-side validation involved. SDKs will continue functioning as expected. The purpose of this update is to make the spec more accurately reflect actual service behavior.

Regarding your changes in the PR: the update in models.tsp looks good. The modification in workspace.tsp‚Äîparticularly for scopes under StorageDiscoveryWorkspace‚Äîis applying the same validation, which is fine. However, since the validation is enforced uniformly by the service, there's no need to treat this as version-specific. Also, the legacy type and the @typeChangedFrom annotations are unnecessary and can be removed.

These aren't TypeSpec rules specifically; it's more about accurately modeling how the service behaves. TypeSpec just makes such changes more visible compared to raw Swagger diffs.

# Need advice on how to change operation parameters on a breaking change

**Category: Versioning**

## question 
Hi all.  My team (Microsoft Translator) is trying to update our POST translate call with a breaking change.  The PR is: [Update translate call to 2025-05-01 by SG-MS ¬∑ Pull Request #33410 ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/pull/33410)
 
The old version (3.0) is being updated to a new version (2025-05-01-preview).  The big change to our typespec definition is that we will be moving most of the request properties from query parameters to the request body.  In 3.0, the only property in the request body was an array of InputTextItem.  InputTextItem is just a string.  All the other relevant data was passed in as query parameters.
 
In 2025-05-01-preview, we want to add a number of additional properties to the request body, so rather than the body consisting of InputTextItem, we want the body to contain a TranslateBody definition, which in turn contains all of our properties.  I'm not sure how to represent this in the tsp files in a compliant way.  
 
Our translate operation in the routes.tsp file is
 
op translate is CustomOperation<
 InputTextItem[],
 TranslateParameters,
 TranslationResult,
 ErrorResponse
\>;
 
The first member of the template is the request body and I need it to be InputTextItem[] for 3.0 and I need it to be TranslateBody for 2025-05-01-preview.  Otherwise one of them will have the wrong set of arguments.  I considered simply updating InputTextItem to contain all the needed parameters in TranslateBody and then removing the unused ones with @added decorators, but the problem is we have a number of other operators in 2025-05-01-preview which use InputTextItem and require it to be just the text string.  
 
Is there anyway to have two different translate operations such that one is called by 3.0 and one is called by 2025-05-01-preview?  I think that's what would really get what I need.  

## answer
the post below might be helpful. It also involves adding a "adding" a newer API on the same route with different method signature. You'd need to add `@sharedRoute` on both methods and point it to the same route.
[Jocelyn Wei: Changing interface's `update` from ArmResourcePatchAsync to ArmCustom... | Azure SDK > TypeSpec Discussion | Microsoft Teams](https://teams.microsoft.com/l/message/19:906c1efbbec54dc8949ac736633e6bdf@thread.skype/1721233288788?tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47&groupId=3e17dcb0-4257-4a30-b843-77f47f1d4121&parentMessageId=1721233288788&teamName=Azure%20SDK&channelName=TypeSpec%20Discussion&createdTime=1721233288788):
```
title: Changing interface's `update` from ArmResourcePatchAsync to ArmCustomPatchAsync without generating breaking changes

question:
Hi TypeSpec Discussion,

I am attempting to follow the playground example here TypeSpec Azure to get past a LintDiff error after adding an MSI to my resource. However, adding the new update model as well as changing the interface from update is ArmResourcePatchAsync<... to update is ArmCustomPatchAsync<... is generating breaking changes for older api versions.

Is there a way to only change the update is.. for the newest api version? I tried using the @added and @removed decorators but the interface complained about duplicate update.

Summary of answer:
To change the update operation from ArmResourcePatchAsync to ArmCustomPatchAsync without generating breaking changes for older API versions:

You also need to use @renamedFrom("update", newVersion) on the old update operation and put @sharedRoute on both.

Make sure you don‚Äôt use a model that is not available in a certain version and carry over the @added/@removed if needed.

If a property like userAssignedIdentities was marked as added in 2023, but the model it depends on (ManagedServiceIdentity) was only added later, it doesn‚Äôt make sense ‚Äî this can be the result of composing shared models.

The sharedRoute might be sharing the new property to the old versions and not honoring the @added and @removed decorators.

If you mark the whole model like:

@added(Microsoft.Mission.Versions.v2024_06_01_preview)  
model ManagedServiceIdentityUpdate  

‚Ä¶errors may occur if parts of the model were added in older versions.

One workaround was to use ManagedServiceIdentityProperty instead of Azure.ResourceManager.Foundations.ManagedServiceIdentity

LintDiff errors like AvoidAnonymousTypes seem to be coming from the MSI additionalProperties section. This error wasn‚Äôt there before setting use-read-only-status-schema: true, but it‚Äôs unclear why that config causes it.

Warnings like "Use the latest version v5 of types.json" for old API versions or EnumInsteadOfBoolean for new ones can be ignored ‚Äî warnings are not required to change for check-in, only errors.

False positives (like Avocado errors) may also occur when using @removed and @added in the same API version ‚Äî especially for preview versions.

If everything is tagged properly and using the latest compiler version, you should be able to get it approved. After that, just follow the normal PR process (e.g., sign-offs, label like WaitForARMFeedback).
```
There is some documentation on this here: [Versioning | TypeSpec Azure](https://azure.github.io/typespec-azure/docs/howtos/arm/versioning/#converting-an-operation-from-synchronous-to-asynchronous) (this is for ARM, but the same principle applies)

# Asynchronous resource delete

**Category: Long Running Operation(LRO)**

## question 
Hi!
 
I'm starting to add new functionality to an existing TypeSpec ([azure-rest-api-specs/specification/orbital/Microsoft.PlanetaryComputer at main ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/tree/main/specification/orbital/Microsoft.PlanetaryComputer)). One of the endpoints I need to implement performs an asynchronous deletion of a resource. I modeled it using `LongRunningResourceDelete` operation:
```
@tag("AI Workflows")
@route("ai")
@added(Versions.v2025_09_30_Preview)
interface AiWorkflows {
  ...

  getAiWorkflowResourceOperationStatus is StandardOperations.GetResourceOperationStatus<AiWorkflow>;

  @pollingOperation(AiWorkflows.getAiWorkflowResourceOperationStatus)
  deleteAiWorkflow is StandardOperations.LongRunningResourceDelete<AiWorkflow>;

  ...
}
```
This emits an OpenAPI with the following endpoints:

DELETE /ai/workflows/{workflowId}
GET /ai/workflows/{workflowId}/operations/{operationId}

I'm trying to understand how this should be implemented, and my first surprise is that I couldn't find a single use of LongRunningDeleteResource in the entire azure-rest-api-specs repo (apart from the widgets example ). Also, I've searched this channel and didn't find any useful information.
 
If the operation status monitor is a child of the resource being deleted, how can I access the status once the delete action is completed? As a client, should I check the resource monitor until I get a 404 error response? Should the status monitor still be available even if the resource was deleted? If the latter is true, what should happen if a new resource is created with the same id?

## answer
The API guidance on lro delete operations is here: [api-guidelines/azure/Guidelines.md at vNext ¬∑ microsoft/api-guidelines](https://github.com/microsoft/api-guidelines/blob/vNext/azure/Guidelines.md#delete-lro-pattern):

```
‚úÖ DO use the following pattern when implementing an LRO operation to delete a resource:

DELETE /UrlToResourceBeingDeleted?api-version=<api-version>
operation-id: <optionalStatusMonitorResourceId>

The response must look like this:

202 Accepted
operation-id: <statusMonitorResourceId>
operation-location: https://operations/<operation-id>

Consistent with non-LRO DELETE operations, if a request body is specified, return 400-Bad Request.

‚úÖ DO allow the client to pass an Operation-Id header with an ID for the operation's status monitor.

‚úÖ DO generate an ID (typically a GUID) for the status monitor if the Operation-Id header was not passed by the client.

‚úÖ DO return a 202-Accepted status code from the request that initiates an LRO if the processing of the operation was successfully initiated.

‚ö†Ô∏è YOU SHOULD NOT return any other 2xx status code from the initial request of an LRO -- return 202-Accepted and a status monitor even if processing was completed before the initiating request returns.
```
 
It is generally required that the StatusMonitor for a particular operation remain for some time after the operation completes.  The simplest way to do this for delete is to use an operations endpoint not using the resource endpoint,  [as in this playground](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3JlIjsKCnVzaW5nIEh0dHA7xwxSZXN0yAxWyVfIEkHEPi5Db3Jl0hIuVHJhaXRzOwoKQHVzZUF1dGgoCiAgQXBpS2V5xA48xgtMb2NhdGlvbi5oZWFkZXIsICJhcGkta2V5Ij4gfCBPxCoyxS9bCiAgICB7xQYgIOQAwTrHH0Zsb3dUeXBlLmltcGxpY2l0LMclYXV0aG9yaXrFYVVybDogIuQBTXM6Ly9sb2dpbi5jb250b3NvLmNvbS9jb21tb24vb8Q1Mi92Mi4wL8hAZSLIUnNjb3BlczogW8lJd2lkZ2V0zUouZGVmYXVsdCJdxjd9CiAgXT4KKQpAc2VydmljZSgjeyB0aXRsZTogIkPGOSBXxUggTWFuYWdlciIgfccvZXLkATcie2VuZHBvaW50fcdy5QCT0D5BUElzxRnmAScvKiogClN1cOQCAWVkyCVT5gCFcyDIU3MgKHByb3RvY29sIGFuZCBob3N0bmFtZSwgZm9yIGV4YW1wbGU6CukA8mVzdHVzLmFwaS7yAP0pLgogKi%2FFfshfOiBzdHJpbmfkAJh95AEG5wKfZWQo5wC%2FLuYAmucA%2FC7nAmhzKQrkAIZzcGFjZSDVKjsKCuQA41RoySDvAUcg5wFxIMdzLuQAnGVudW3oAsxz5QEqxEXHESAyMDIyLTA4LTMxxCwgIOQCvURlcGVuZGVuY3ko6wLgyEMudjFfMF9QcmV2aWV3XzIpCiAgYMlGMGAsCn0KCi8vIE1vZGVscyAv0wHqAMdjb2xvciBvZiBhIOcBXOQAhnVu5ACa5gDbQ8Ui5AC26AFW5wDBQmxhY2vHJSDGJuUAwcUYOiAixQgiyS9XaGl0ZdMvxRg6ICLFCMovUuoCQMstUmVkOiAiUmVkyilHcmVl6ACszCvFGDogIsUIyi9CbHX0AIbEF%2BUAtHXkAITkAUEqKiBB7AEUQHJlc291cmNlKCLGFnMiKQpt5AFkyE%2FoAdrkAVjGIyDkAlDFPiAgQGtlecg7TmFtZSLkAbhAdmlzaWJpbGl0eShMaWZlY3ljbGUuUmVhZMQexD7oAs076ADBy17lAb3HX8UMOuwBtM0ySUTkAeV0yTwncyBtYW51ZmFjdHVyZchFzBNJZM17Li4uRXRhZ1Byb3BlcnR5O%2BcCZU9wZXLlBO74AmlhbGlhc%2BgEA%2BYFoiA9IOcEJHNSZXBlYXRhYmxlUmVxdWVzdHMgJgogyR9Db25kacReYWzWIGxpZW50xxtJZDvIb%2BsAlj3sBiJS5wHDyiA87QCaPuQGPeoB6OQA68Yn7wHrRGVsZXTKRlN0YXR1cyBpcyBGb3VuZMYzLs8fPG5ldmVyPjsKaW50ZXJm5ARkxk3nBBPrAUwgxjLoAuHEI3PGY%2BUDqcY3IOkAnugCYXNoYXJlZFJvdXRlCiAgZ2V0xinzAKfJE3MuR2V08QEWxik8xj8%2BO%2F8AiGTlAQ3%2FAI%2FqAI%2F5ATzJE3PpAajkAwnnAIfVN%2BQBsOUBO8Yky0PnALRDcmVhdGVzIG9yIHVwZMUL6QC4YXN5bmNocm9ub3VzbHnnALVwb2xsaW5nyUkoxi1zLvgBT%2BQDqGPFZk9yVcVjx1%2FuANJMb25nUnVu5AjM6ADd5gCcyDbqAW7qAW%2FqAKzlAJ3pAIP%2FAS7NR%2BYBOPgA9ugBrP8A9%2FgBgOQA%2FeYB%2F%2F8A9ekA9cZH8QCmTGlzdOgAougDgHPmAJxsaXPnAIP4AibEPTzlCALGKOYJBcQWUXVlcnlQYXJhbWV0ZXJz5QPlPFN0YW5kYXJk0yEgJiBTZWxlY88YPgogID7kBPI%3D&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fdata-plane%22%5D%7D%7D). 
```
@service(#{ title: "Contoso Widget Manager" })
@server(
  "{endpoint}/widget",
  "Contoso Widget APIs",
  {
    /** 
Supported Widget Services endpoints (protocol and hostname, for example:
https://westus.api.widget.contoso.com).
 */
    endpoint: string,
  }
)
@versioned(Contoso.WidgetManager.Versions)
namespace Contoso.WidgetManager;

/** The Contoso Widget Manager service version. */
enum Versions {
  /** Version 2022-08-31 */
  @useDependency(Azure.Core.Versions.v1_0_Preview_2)
  `2022-08-30`,
}

// Models ////////////////////

/** The color of a widget. */
union WidgetColor {
  string,

  /** Black Widget Color */
  Black: "Black",

  /** White Widget Color */
  White: "White",

  /** Red Widget Color */
  Red: "Red",

  /** Green Widget Color */
  Green: "Green",

  /** Blue Widget Color */
  Blue: "Blue",
}

/** A widget. */
@resource("widgets")
model Widget {
  /** The widget name. */
  @key("widgetName")
  @visibility(Lifecycle.Read)
  name: string;

  /** The widget color. */
  color: WidgetColor;

  /** The ID of the widget's manufacturer. */
  manufacturerId: string;

  ...EtagProperty;
}

// Operations ////////////////////

alias ServiceTraits = SupportsRepeatableRequests &
  SupportsConditionalRequests &
  SupportsClientRequestId;

alias Operations = Azure.Core.ResourceOperations<ServiceTraits>;

@resource("operations")
model WidgetDeleteOperationStatus is Foundations.OperationStatus<never>;
interface Widgets {
  // Operation Status
  /** Gets status of a Widget operation. */
  @sharedRoute
  getWidgetOperationStatus is Operations.GetResourceOperationStatus<Widget>;
  /** Gets status of a Widget delete operation. */
  @sharedRoute
  getWidgetDeleteOperationStatus is Operations.ResourceRead<WidgetDeleteOperationStatus>;

  // Widget Operations
  /** Creates or updates a Widget asynchronously */
  @pollingOperation(Widgets.getWidgetOperationStatus)
  createOrUpdateWidget is Operations.LongRunningResourceCreateOrUpdate<Widget>;

  /** Get a Widget */
  getWidget is Operations.ResourceRead<Widget>;

  /** Delete a Widget asynchronously. */
  @pollingOperation(Widgets.getWidgetDeleteOperationStatus)
  deleteWidget is Operations.LongRunningResourceDelete<Widget>;

  /** List Widget resources */
  listWidgets is Operations.ResourceList<
    Widget,
    ListQueryParametersTrait<StandardListQueryParameters & SelectQueryParameter>
  >;
}
``` 
 
Any lro over a resource that might change or remove the resource id should not use the resource itself in the StatusMonitor endpoint.
 
It would be nice if both our samples reflected this and our templates made this easier.  If you'd like to file an issue for this, please do so here: https://github.com/Azure/typespec-azure/issues (or I will add this to our existing issue for updating StatusMonitor support in Azure Core)
 
# Array items with length constraints

**Category: Decorators**

## question 
Hi all. I got a model with an [array](https://github.com/Azure/azure-rest-api-specs/blob/72d218043b48fbf70c67382d7d90e2018cfb37da/specification/storage/resource-manager/Microsoft.Storage/stable/2024-01-01/blob.json#L1267) and items is constraint by length. I wonder if this is legal in OpenAPI? 
```
 "tags": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 23,
            "minLength": 3
          },
          "description": "Each tag should be 3 to 23 alphanumeric characters and is normalized to lower case at SRP."
        },
```
 
If it's legal, how could I implement this constraint in typespec?

## answer
If you meant that you wanted to constrain the number of items in the array, you can do this with the @[minItems](https://typespec.io/docs/standard-library/built-in-decorators/#@minItems) @[maxItems](https://typespec.io/docs/standard-library/built-in-decorators/#@maxItems) decorators: 
 
And this is perfectly legal in Azure Specs (it is best that you encode these kinds of limits, if only for documentation purposes).
 
However, changing these limits in the future can result in breaking changes for customers 

# Typespec Validation required check

**Category: TypeSpec Validation**

## question 
PR: https://github.com/Azure/azure-rest-api-specs/pull/35346
This PR only has typespec conversion change and no API update. It is currently failing for required check - Typespec validation. When I run the npx tsmv command locally then I see the following error.
```
Executing rule: SdkTspConfigValidation
Validation on option "options.@azure-tools/typespec-csharp.namespace" in "@azure-tools/typespec-csharp" are failed. However, per @azure-tools/typespec-csharp‚Äôs decision, we will treat it as passed.
[SdkTspConfigValidation]: validation failed.
- Failed to find "parameters.service-dir.default". Please add "parameters.service-dir.default".
- The value of options.@azure-tools/typespec-java.package-dir "azure-mgmt-devtestlabs" does not match "/^azure-resourcemanager-[^\/]+$/". Please update the value of "options.@azure-tools/typespec-java.package-dir" to match "/^azure-resourcemanager-[^\/]+$/".
- The value of options.@azure-tools/typespec-java.namespace "com.microsoft.azure.management.devtestlabs" does not match "/^com\.azure\.resourcemanager\.[^\.]+$/". Please update the value of "options.@azure-tools/typespec-java.namespace" to match "/^com\.azure\.resourcemanager\.[^\.]+$/".
- Failed to find "options.@azure-tools/typespec-go.service-dir". Please add "options.@azure-tools/typespec-go.service-dir".
- Failed to find "options.@azure-tools/typespec-go.package-dir". Please add "options.@azure-tools/typespec-go.package-dir".
- The value of options.@azure-tools/typespec-go.module "github.com/Azure/azure-sdk-for-go/{module-name}" does not match "github.com/Azure/azure-sdk-for-go/{service-dir}/{package-dir}". Please update the value of "options.@azure-tools/typespec-go.module" to match "github.com/Azure/azure-sdk-for-go/{service-dir}/{package-dir}".
- Failed to find "options.@azure-tools/typespec-go.fix-const-stuttering". Please add "options.@azure-tools/typespec-go.fix-const-stuttering".
- Failed to find "options.@azure-tools/typespec-go.generate-samples". Please add "options.@azure-tools/typespec-go.generate-samples".
- Failed to find "options.@azure-tools/typespec-go.generate-fakes". Please add "options.@azure-tools/typespec-go.generate-fakes".
- Failed to find "options.@azure-tools/typespec-go.head-as-boolean". Please add "options.@azure-tools/typespec-go.head-as-boolean".
- Failed to find "options.@azure-tools/typespec-go.inject-spans". Please add "options.@azure-tools/typespec-go.inject-spans".
- Failed to find "options.@azure-tools/typespec-python.package-dir". Please add "options.@azure-tools/typespec-python.package-dir".
- The value of options.@azure-tools/typespec-csharp.namespace "Microsoft.Azure.Management.DevTestLabs" does not match "{package-dir}" or the value of "package-dir" option or parameter. Please update the value of "options.@azure-tools/typespec-csharp.namespace" to match "{package-dir}" or the value of "package-dir" option or parameter.
Please see https://aka.ms/azsdk/spec-gen-sdk-config for more info.
For additional information on TypeSpec validation, please refer to https://aka.ms/azsdk/specs/typespec-validation.
```
I have copied the namespace from the autorest readme files that we had before and it was responsible  to generate SDKs. Is it a requirement to update the namespace as suggested given we have already published the SDK before?

## answer
typeSpec validation is failing, but not for that reason.  The configuration for c-sharp emitter is a warning only.  The current failure is caused by diffs between the generated swagger included in your PR and the generated swagger when the ci compiles your spec.
 
Usually this indicates that your local dependencies are out of date, and you need to pull the latest into your local branch and re-install at thetop level:
 
git fetch upstream main
git pull upstream main
npm ci
https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation#running-locally:
```
Running Locally

To ensure you see the same results from TypeSpecValidation in your PR check and tsv on your local machine:

1.Merge latest from parent (e.g. main or RPSaaSMaster) to your PR branch
2.Run locally
git clean -xdf (may revert any local changes)
git pull
npm ci
npx tsv specification/contosowidgetmanager/Contoso.Management
git status
If any changes, git add, git commit, git push to update your PR.
3.If you are still having problems, try cloning your branch to a new folder, or try on another machine.
4.If the problem can be reproduced on a clean machine, request assistance from the TypeSpec Discussion teams channel.
```

# Missing APIs in default tag error for typespec conversion PR

**Category: SDK Generation**

## question 
PR: https://github.com/Azure/azure-rest-api-specs/pull/35346
Avocado check: https://github.com/Azure/azure-rest-api-specs/pull/35346/checks?check_run_id=44368323389
 
Is there a way to suppress the missing APIs check only for this PR since it only has typspec conversion but no update to the open API spec?
The check is trying to compare the APIs with previous stable release with currently published stable release.

## answer
Part of the typespec conversion is replacing the existing swagger with a generated swagger.  The generated swagger is still used for some purposes, and Avocado protects the ability to process it. The generated swagger needs to be equivalent, but not necessarily identical.  Generally these issues reflected in the swagger will also show up in breaking change checks, which will have to be resolved (or suppressed if they are false positives)

# Can I have different Name Regex for ARM Resource for different api versions?

**Category: Versioning**

## question 
Hi Team,
 
In swagger our model is defined as
```
@doc("Dynamic Configuration Resource")
@parentResource(DynamicConfiguration)
@resource("versions")
model DynamicConfigurationVersion
  is ProxyResource<DynamicConfigurationVersionProperties> {
  ...ResourceNameParameter<
    DynamicConfigurationVersion,
    NamePattern = "^[a-zA-Z0-9.-]{3,24}$"
  >;
}
```
This namePattern is in current `2024-09-01-preview` version but in our new version i want to increase length and update regex from `^[a-zA-Z0-9.-]{3,24}$` to `^[a-zA-Z0-9.-]{3,24}$` in new `2025-06-01` version.
 
Is there any way to achieve this or I need to change this for all api versions?

## answer
does your service actually validate differently across version or you want to update to a new regex
This this issue for existing ask https://github.com/Azure/typespec-azure/issues/2355
issue content:
```
Document changing pattern

@johanste input

"
If bugfix, it goes into all. I suspect that is the most common.

If restricting what was previously valid input, it is a breaking change. If expanding on what is valid output for a previously valid input, it is a breaking change. Breaking changes go through breaking change board. I hope that is the lest common.

If it is a expanding outputs but only if the client sends something that was previously no possible to send (or, rather, the service would have rejected the call), it should be discussed in API review board. There are degrees of breakingness to this. I would make the case in review board to add to all, but I need a couple of concrete examples for the rest of the API review board to fully grok the implications I think. I have not a good picture of how common this is.'
"

Everytime this has come up it was a bug fix and so all specs should be fixed

an in more general document how to workaround the versioining of decorator
```
unless your service actually validates names differently between the versions, the recommendation is to make this change for all versions - client SDKs do not use name patterns, and this is just accurately describing what your service does.

# Is it possible to make a field to be optional only on new api version?

**Category: Versioning**

## question 
Hi TypeSpec Discussion,
 
In swagger, we have below data model. We want to make StageSpec.specification to be optional from 2025-06-01-preview version, but for older versions, it is still mandatory.
 
I tried below implementation, but it failed during tsp compile. Compiler complains the field name is duplicated.
 
Is there any way to achieve this? Really appreciate if there's any examples.
```
Diagnostics were reported during compilation:
 
[36mWorkflowVersion.tsp[39m:[33m95[39m:[33m3[39m - [31merror[39m [90mduplicate-property[39m: Model already has 
a property named specification
> 95 |   specification?: Record<unknown>;
     |   ^^^^^^^^^^^^^
 
Found 1 error.
```
```
@doc("Stage Properties")
model StageSpec {
  @doc("Name of Stage")
  name: string;

  @removed(Versions.v2025_06_01_preview)
  @doc("Target ARM id")
  targetId?: string;

  #suppress "@azure-tools/typespec-azure-core/no-unknown" "Suppress no-unknown to handle the datatype object used in dependent service"
  #suppress "@azure-tools/typespec-azure-resource-manager/arm-no-record" "Suppress arm-no-record to handle the datatype object used in dependent service"
  @doc("Stage specification")
  @removed(Versions.v2025_06_01_preview)
  specification: Record<unknown>;

  #suppress "@azure-tools/typespec-azure-core/no-unknown" "Suppress no-unknown to handle the datatype object used in dependent service"
  #suppress "@azure-tools/typespec-azure-resource-manager/arm-no-record" "Suppress arm-no-record to handle the datatype object used in dependent service"
  @doc("Stage specification")
  @added(Versions.v2025_06_01_preview)
  specification?: Record<unknown>;

  @added(Versions.v2025_06_01_preview)
  @doc("List of tasks in the stage")
  tasks: TaskSpec[];

  @added(Versions.v2025_06_01_preview)
  @doc("Task option for the stage")
  taskOption?: TaskOption;
}
```

## answer
You should use the @madeOptional decorator, here: [Decorators | TypeSpec](https://typespec.io/docs/libraries/versioning/reference/decorators/#@TypeSpec.Versioning.madeOptional).  Note that, making a property that occurs in responses optional is considered a breaking change.

# Internal compiler error

**Category: TypeSpec Validation**

## question 
I have an interface in typespec with the following method:
```
  @operationId("VirtualMachines_UnClaim")
  unClaim is ArmResourceActionAsync<LabVirtualMachine, void, AcceptedResponse>;
```
This throw compilation error as follows:
```
TypeSpec compiler v1.1.0

√ó Compiling...
Internal compiler error!
File issue at https://github.com/microsoft/typespec

Error: Multiple responses are not supported.
    at getResponseBody (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@azure-tools/typespec-azure-resource-manager/dist/src/rules/arm-post-response-codes.js:21:23)
    at validateAsyncPost (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@azure-tools/typespec-azure-resource-manager/dist/src/rules/arm-post-response-codes.js:42:29)
    at root (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@azure-tools/typespec-azure-resource-manager/dist/src/rules/arm-post-response-codes.js:86:29)
    at file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/linter.js:125:49
    at time (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/stats.js:11:5)
    at timedCb (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/linter.js:125:38)
    at EventEmitter.emit (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/semantic-walker.js:367:17)
    at listener.<computed> [as root] (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/semantic-walker.js:63:26)
    at Object.emit (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/semantic-walker.js:81:49)
    at navigateProgram (file:///C:/Users/nandiniy/v3/azure-rest-api-specs/node_modules/@typespec/compiler/dist/src/core/semantic-walker.js:14:13)
```
If the response is OkResponse in the method then I am able to compile it successfully but I want to update the generated swagger such that the response type is either 202 or default based on the lint rule: [azure-openapi-validator/docs/post-response-codes.md at main ¬∑ Azure/azure-openapi-validator](https://github.com/Azure/azure-openapi-validator/blob/main/docs/post-response-codes.md):
```
Description
Synchronous POST operations must have one of the following combinations of responses - 200 and default ; 204 and default. They also must not have other response codes. Long-running POST operations must have responses with 202 and default return codes. They must also have a 200 return code if only if the final response is intended to have a schema, if not the 200 return code must not be specified. They also must not have other response codes. 202 response for a LRO POST operation must not have a response schema specified.
```

## answer
Since this is an Async operation, the accepted response is part of the template.  What you want to provide in this case is the logical response (here, it sounds like void, [as in this playground](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIsdXyC1IdWJDbGllbnQiIH0pCkDnAUNlZCjnAL9zKQpuyFAgTWljcm9zb2Z0LtJG7wC2QVBJIMdNc%2BQAoWVudW3oARNzIHsKICDELjIwMjEtMTAtMDEtcHJldmlld8g1xDQgIEB1c2VEZXBlbmRlbmN5KPUBLy7IVi52MV8wX1DGSF8xKcRAYXJtQ29tbW9uVOQBz8cq10jLKctUNcRIYPIAqWAsCn3mAPNB6AD16wEOIOgCMOQAyG1vZGVsIEVtcGxveWVlIGlzIFRyYWNrZWToAII8yBxQcm9wZXJ0aWVzPuUBJC4u6QCm5AHWUGFyYW1ldGVyyTE%2BO%2BgAhslfcMlE0nzKYOkBg0FnZSBvZiBlyD%2FlAXhhZ2U%2FOiBpbnQzMjsKxylDaXR50ipjaXR5Pzogc3Ry5QLpxyxQcm9maWzTWUBlbmNvZGUoImJhc2U2NHVybCLkAWBwxjA%2FOiBieXRlc8lIVGhlIHN0YXR1c8RLdGhlIGxhc3Qg5ADFYXRpb27lAvwgIEB2aXNpYmlsaXR5KExpZmVjeWNs5AHgYWTHXcQg5QOLU3RhdMRn5QGrzBTpAUjEc8wy5QCA5QDKYekB1cV3QGxyb8Q7dXMKdW7kArLRVOUBZOYBGizsANLIRyBjcmXEJ3JlcXVlc3QgaGFzIGJlZW4gYWNjZXB0ZWTEZyAgQccOOiAiyAsi1lBpxEDkALTpAMHIROwAnDogIswP2kx1cGRhdMRPxUNVxw46ICLIC8o76QSl6QDE5gDcZOcBolN1Y2NlZWTlAMXJDNM%2FxTbkAU1mYWlsyT5GxQ06ICLGCdw4d2FzIGNhbmNlyj5Dxw%2FkBP3HC%2F8BQCBkZWxl6QGARMQN5gD5yAsi6QP96QN3bW926gHK6QN5TW92ZVLHFegDcsRzbW92xGhmcm9tIGxvY%2BYAvMVuxBPxA1DLM3RvzzF0b8ov9wCVc3BvbnPrBIvmAJbHFuwAl%2B4DbMU%2BxWTGfOYC7s1uaW50ZXJm5AYcT%2BgDlHMgZXh0ZW5kc%2FYG3i7LKXt9CuUGusgjyhvLWegAzeYEs2dldOQBp0HKNeQD5%2BwFECDnAntPcuUCp%2BUB1ssvQ8cdUmVwbGFjZUFzeW5jzj%2FlAvfIN0N1c3RvbVBhdGNoU8QqCiAgIOkAkyzFDvYA50ZvdW7kAybkBkXIHOYAkU3kAYTGSdBLyhDqBarFGT4KICDlAJ3mAprvANTlApdlV2l0aG91dE9r8wDUbGlzdEJ5yDBHcm91cM9ETMUiUGFyZW501DxTdWJzY3JpcOUCecY7xjPMGcw56AZgIHNhbXBs6wNmYWPFRHRoYXTmAmPpBiN0byBkaWZmZeQAhO8C5sUp7gCyQcVI5QGWyHcsIHZvaWTGBvMAg0hFQUTqBj3Eb2NoZWNr6gCbZXhpc3RlbuYHtyDGHkXJFM5%2FQ80d7geS&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D)).
```
/** A ContosoProviderHub resource */
model Employee is TrackedResource<EmployeeProperties> {
  ...ResourceNameParameter<Employee>;
}

/** Employee properties */
model EmployeeProperties {
  /** Age of employee */
  age?: int32;

  /** City of employee */
  city?: string;

  /** Profile of employee */
  @encode("base64url")
  profile?: bytes;

  /** The status of the last operation. */
  @visibility(Lifecycle.Read)
  provisioningState?: ProvisioningState;
}

/** The provisioning state of a resource. */
@lroStatus
union ProvisioningState {
  string,

  /** The resource create request has been accepted */
  Accepted: "Accepted",

  /** The resource is being provisioned */
  Provisioning: "Provisioning",

  /** The resource is updating */
  Updating: "Updating",

  /** Resource has been created. */
  Succeeded: "Succeeded",

  /** Resource creation failed. */
  Failed: "Failed",

  /** Resource creation was canceled. */
  Canceled: "Canceled",

  /** The resource is being deleted */
  Deleting: "Deleting",
}

/** Employee move request */
model MoveRequest {
  /** The moving from location */
  from: string;

  /** The moving to location */
  to: string;
}

/** Employee move response */
model MoveResponse {
  /** The status of the move */
  movingStatus: string;
}

interface Operations extends Azure.ResourceManager.Operations {}

@armResourceOperations
interface Employees {
  get is ArmResourceRead<Employee>;
  createOrUpdate is ArmResourceCreateOrReplaceAsync<Employee>;
  update is ArmCustomPatchSync<
    Employee,
    Azure.ResourceManager.Foundations.ResourceUpdateModel<
      Employee,
      EmployeeProperties
    >
  >;
  delete is ArmResourceDeleteWithoutOkAsync<Employee>;
  listByResourceGroup is ArmResourceListByParent<Employee>;
  listBySubscription is ArmListBySubscription<Employee>;

  /** A sample resource action that move employee to different location */
  move is ArmResourceActionSync<Employee, void, void>;

  /** A sample HEAD operation to check resource existence */
  checkExistence is ArmResourceCheckExistence<Employee>;
}
```

# Untitled

**Category: TypeSpec Validation**

## question 
Hi All, the 'tsp compile .' command is throwing the following error. Could anyone kindly help with resolving the error? 
error file-load: Package subpath './experimental' is not defined by "exports" in C:\VSTS\PDG\ActiveGlossary\typespec\node_modules\@typespec\http\package.json imported from C:\VSTS\PDG\ActiveGlossary\typespec\node_modules\@typespec\rest\dist\src\rest.js
error file-load: Package subpath './experimental' is not defined by "exports" in C:\VSTS\PDG\ActiveGlossary\typespec\node_modules\@typespec\http\package.json imported from C:\VSTS\PDG\ActiveGlossary\typespec\node_modules\@typespec\rest\dist\src\rest.js
error file-load: Package subpath './typekit' is not defined by "exports" in C:\VSTS\PDG\ActiveGlossary\typespec\node_modules\@typespec\compiler\package.json imported from C:\VSTS\PDG\ActiveGlossary\typespec\node_modules\@azure-tools\typespec-azure-core\dist\src\decorators.js
error import-not-found: Couldn't resolve import "@azure-tools/typespec-autorest"

## answer
This seems like you have an issue with the dependencies you have installed. Did you get any error when using npm install? What versions are you using? Try a fresh install (delete node_modules first).

These are not compatible. Please upgrade to the latest or make sure you are using versions that match if you can't for now.

For the latest, you can look on npm: https://www.npmjs.com/package/@typespec/compiler
Or at the bottom of the repo: https://github.com/microsoft/typespec

There are 3 version groups you need to know since we are at 1.0:

Stable packages: 1.x (compiler, http, openapi, openapi3)

Core preview packages: 0.y (rest, versioning, stream, see)

Azure packages: 0.z (all Azure packages)
All packages in the same group have the same major.minor version.

If you are in the spec repo, read this doc for next steps:
https://github.com/Azure/azure-rest-api-specs/blob/main/documentation/typespec-rest-api-dev-process.md

# Using namespaces and encountering duplicate-symbol error

**Category: Arm Resource Manager(ARM) Template**

## question 
I'm trying to decorate some types with a namespace, but I'm getting a duplicate-symbol error. Is there something wrong with the usage in the example below? I don't have any other usages of `namespace Chat` or `namespace OpenAI.Chat`.
```
namespace OpenAI.Chat{

Error message:
Duplicate name: "Chat" Typespec(duplicate-synbol)
namespace OpenAI.Chat
```

Something interesting I noticed is that there is another duplicate error for an interface declaration. Do these two concepts conflict?
```
@route("/chat")
interface Chat{
  @route("completions")
  @post
  @operationId("createChatCompletio
  @tag("Chat")
  @summary("Creates a model respons
  createChatCompletion(
```

## answer
yes names should be unique across all types
Every container (namespace, interface, model) identifies its elements by name.  So, within a container, all types have to have unique names.  Because namespaces can contain different types (including other namespaces), this is where you are most likely to encounter the issue.

# Is adding new value to enum is considered a breaking change?

**Category: Versioning**

## question 
Hi Team,
 
We are working on Workload Orchestration Service which is going to GA soon. In swagger, we have data models where we have enum defined as

```
union State {
  InReview: "InReview",
  UpgradeInReview: "UpgradeInReview",
  ReadyToDeploy: "ReadyToDeploy",
  ReadyToUpgrade: "ReadyToUpgrade",
  Deploying: "Deploying",
  Deployed: "Deployed",
  Failed: "Failed",
  Undeployed: "Undeployed",
  PendingExternalValidation: "PendingExternalValidation",
  ExternalValidationFailed: "ExternalValidationFailed",
  Staging: "Staging",
  string,
}

model SolutionProperties {
  resourceState: State
}
```
In future, if we add new value to this existing enums in same api-version after GA, then will it be considered as breaking change or not? Will it cause any failure anywhere in swagger, SDK, etc?

## answer
extensible union as defined in your example wouldn't count as a breaking change to add a new entry as it defines this as already allowing any string
For clarity,  an 'extensible enum'  is represented in TypeSpec as an open union.  That is a union of string values that include string as a variant (`union Foo { Bar: "bar", Baz: "baz", string}`).  In this case, adding new values is not a breaking change, but removing values is
 
An enum or closed union (union with just literal string variants, `union Foo {Bar: "bar", Baz: "baz"}`) is considered a closed enum, which means that adding or removing values is a breaking change.
 
The reason for the difference is that some SDKs have enumeration types that are used when an enum is comprehensive (closed),  but not used if the enum is partial.  When the enumeration types are used, customer code can break if it processes each of the variants explicitly.
 
This is why we highly recommend use open enumerations in most cases, and to use a closed enum you have to suppress a linting rule.

# Untitled

**Category: TypeSpec Migration**

## question 
Hi All, when I run the tsp-client convert --swagger-readme .\spec.json command, it throws this error
 
error   | Autorest completed with an error. If you think the error message is unclear, or is a bug, please declare an issues at https://github.com/Azure/autorest/issues with the error message you are seeing.
error   | invalidType | Expected a boolean but got object: { title: 'Purview Data Catalog Client', version: '2023-10-01-preview' }
    - file:///C:/VSTS/PDG/ActiveGlossary/typespec/spec.json:3:3


## answer
You should use the `readme.md`, not the swagger file, as input.
Refer to the migration guide: https://azure.github.io/typespec-azure/docs/migrate-swagger/01-get-started/

Do you have a `readme.md` or another autorest markdown configuration file?
Is that spec part of the Azure REST API spec repo?
Did you actually run the command using the `readme.md` as input?

Try running `autorest <readme>`.
Also, your `spec.json` must be a valid Swagger file ‚Äî from the error, you likely have a name mismatch (casing issue).

You can validate the Swagger file at: https://editor.swagger.io/ ‚Äî that‚Äôs a good place to start.
But be aware: Autorest imposes additional restrictions, so you may need to keep running `autorest` or `tsp-client convert` repeatedly until the spec passes.

# help with @added(multipleversion) vs @removed(oldversion)

**Category: Versioning**

## question 
Hi Team,  I am working on new api version and we have couple properties that are added in last api verison (viz., v2 version onwards).
 
we have 3 apiversions v1 the new property is not present.
v2 the property is added.
v3 also it need to be there.
 
so can i add @removed (v1) for this property? 
instead of 
@added (v2) 
@added(V3)
as decorators?
 
here is the actual change i was making :
@added(Versions.v2024_11_30_preview)
@added(Versions.v2025_06_15)
@doc("Number of cache node issues.")
@visibility(Lifecycle.Read)
 issuesCount?: int32;
 
can this be modified as below?
 
@removed(Versions.v2023_05_01_preview)
@doc("Number of cache node issues.")
@visibility(Lifecycle.Read)
  issuesCount?: int32;
 
any feedback in here is greatly appreciated.

## answer
if the version is added in v2 it will be available in all subsequent versions until removed, you shouldn't say you added it in multiple versions
 
the versioning is linear

# Visibility Choice

**Category: Decorators**

## question 
Hi team,
 
Could someone please help me explain the difference between @visibility(LifeCycle.Read) and  @visibility(Lifecycle.Create, LifeCycle.Read) 

## answer
If the visibility is read, the client cannot provide the value (it is generated by the service). For create + read, the client can provide the value, but only when the resource is created. Once set, the client cannot change it in subsequent update methods. 

# SDK Generation failure

**Category: SDK Generation**

## question 
Hi Team,
 
I am seeing an SDK generation failure in my PR. Can you help what we are doing wrong? [Support multidownload support by aneesh-ponneth ¬∑ Pull Request #22690 ¬∑ Azure/azure-rest-api-specs-pr](https://github.com/Azure/azure-rest-api-specs-pr/pull/22690/checks?check_run_id=43636536312)

```
Build log #L251

Errors occurred while generating SDK from specification/edge. Follow the steps at https://aka.ms/azsdk/sdk-automation-faq#how-to-view-the-detailed-sdk-generation-errors to view detailed errors.
2025-06-06 18:23:40 [ERROR] Error occurred when call tsp-client:
2025-06-06 18:23:40 [ERROR] fail to generate sdk for specification/edge/Microsoft.Edge.DisconnectedOperations.Management: Command 'tsp-client init --tsp-config /mnt/vss/_work/1/s/azure-rest-api-specs-pr/specification/edge/Microsoft.Edge.DisconnectedOperations.Management --local-spec-repo /mnt/vss/_work/1/s/azure-rest-api-specs-pr/specification/edge/Microsoft.Edge.DisconnectedOperations.Management --commit 788b0c469a26449b7c083547ca2ab1635865423b --repo Azure/azure-rest-api-specs-pr --skip-install --debug' returned non-zero exit status 1.
2025-06-06 18:23:40 [ERROR] ======================================= Whant Can I do (begin) ========================================================================
2025-06-06 18:23:40 [ERROR] Fail to generate sdk for specification/edge/Microsoft.Edge.DisconnectedOperations.Management. If you are from service team, please first check if the failure happens only to Python automation, or for all SDK automations. 
2025-06-06 18:23:40 [ERROR] If it happens for all SDK automations, please double check your Swagger / Typespec, and check whether there is error in ModelValidation and LintDiff. 
2025-06-06 18:23:40 [ERROR] If it happens to Python alone, you can open an issue to https://github.com/Azure/autorest.python/issues. Please include the link of this Pull Request in the issue.
2025-06-06 18:23:40 [ERROR] ======================================= Whant Can I do (end) =========================================================================
Refer to the inner logs for details or report this issue through https://aka.ms/azsdk/support/specreview-channel.
ErrorStack: Error: [EXT-ERR] Failed to read generateOutput.json. Please check if the generate script is configured correctly.
```
 
and below is the error details [Pipelines - Run 20250606.27 logs](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=4949592&view=logs&j=83516c17-6666-5250-abde-63983ce72a49&t=00be4b52-4a63-5865-8e02-c61723ad0692). 
 
Error log
[dev.azure.com/azure-sdk/590cfd2a-581c-4dcb-a12e-6568ce786175/_apis/build/builds/4949592/logs/15](https://dev.azure.com/azure-sdk/590cfd2a-581c-4dcb-a12e-6568ce786175/_apis/build/builds/4949592/logs/15)

## answer
From the GO messages,  it looks like there are a couple of unresolved imports:
```
/models.tsp:4:1 - error import-not-found: Couldn't resolve import "@typespec/openapi3"
/images.tsp:7:1 - error import-not-found: Couldn't resolve import "../Microsoft.Edge.Shared/common.tsp"
```

To be clear,  you should not import @typespec/openapi3 as part of your spec.  Unless you are using openapi3-specific decorators (which you should not) this import is most likely unnecessary

# Handling multiple API versions using typespec

**Category: Versioning**

## question 
Hi Team,
 
I am releasing a new API version and looks there is a new validation to check existing swagger with new tsp file 
 
"appears to contain TypeSpec-generated swagger files, not generated from the current TypeSpec sources. Perhaps you deleted a version from your TypeSpec, but didn't delete the associated swaggers?"
 
We want to keep both old and new api versoins. What is the suggestion here? Do you suggest to create different TSP file for each version/use versioning in existing TSP? 
 
If second case, can you share some example where APIs/Properties are added/removed in a newer version

## answer
The idea behind TypeSpec versioning is to model the diffs in your API, encouraging best practices for API evolution. If you have questions about modeling particular changes, feel free to ask.

About your concern: fixing a new validation causing changes to older APIs‚Äîthis usually happens when new changes are added without using the appropriate version decorators. For example:

If you added properties or made a property optional, but didn‚Äôt annotate them with @added or @madeOptional, then they would apply to all versions by default, including older ones.

That‚Äôs likely why your stable version (e.g., 2024-12-01) got unintentionally updated when you only meant to target 2025-07-01-preview.

To avoid this, always use decorators like @added and @madeOptional to indicate version-specific changes.

As for the location field and the read/create mutability warning:
That rule is a warning meant to be advisory. In your case, it doesn‚Äôt seem to apply‚Äîso this is a good example where you should not change the service behavior just to satisfy a linting rule. It's fine to ignore the warning here.

Regarding your question on renaming an API response (e.g., from MoveResponse to MoveResult):
If the new name is meant for a specific version, ensure it‚Äôs versioned properly in your TypeSpec. In your repro, the naming appears correct‚ÄîMoveResult in 2021-10-01-preview, and MoveResponse in 2024-10-01-preview‚Äîso it‚Äôs working as expected.

Finally, for adding or removing a parameter in only the new version:
Unfortunately, you can‚Äôt directly decorate a spread parameter. The best way is to use operation-specific parameters, which you can decorate with versioning decorators. You could alternatively decorate the core parameter definition (e.g., with an augment decorator), but that would affect every usage‚Äîso for localized changes, use operation-specific ones. Since this is a method parameter, the APIs are equivalent and the change has no SDK impact.

# TypeSpec Validation failed

**Category: TypeSpec Validation**

## question 
In this [PR](https://github.com/Azure/azure-rest-api-specs/pull/34282), [TypeSpec Validation](https://github.com/Azure/azure-rest-api-specs/actions/runs/15438271648/job/43449735963?pr=34282) failed. 
```
 Files have been changed after `tsp compile`. Run `tsp compile` and ensure all files are included in your change.
  Error: TypeSpec Validation failed for project specification/powerbidedicated/Powerbidedicated.Management run the following command locally to validate.
   > npm ci
   > npx tsv specification/powerbidedicated/Powerbidedicated.Management
  For more detailed docs see https://aka.ms/azsdk/specs/typespec-validation
  Removing specification/powerbidedicated/resource-manager/Microsoft.PowerBIDedicated/
TypeSpec Validation failed for some folder to fix run and address any errors:
 > npm ci
 > npx tsv specification/powerbidedicated/Powerbidedicated.Management
For more detailed docs see https://aka.ms/azsdk/specs/typespec-validation
Error: Process completed with exit code 1.
```
I cannot repro in my local machine. 

## answer
Repros locally for me on linux.  Follow instructions here: https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation#running-locally

```
Running Locally
To ensure you see the same results from TypeSpecValidation in your PR check and tsv on your local machine:

Merge latest from parent (e.g. main or RPSaaSMaster) to your PR branch
Run locally
git clean -xdf (may revert any local changes)
git pull
npm ci
npx tsv specification/contosowidgetmanager/Contoso.Management
git status
If any changes, git add, git commit, git push to update your PR.
If you are still having problems, try cloning your branch to a new folder, or try on another machine.
If the problem can be reproduced on a clean machine, request assistance from the TypeSpec Discussion teams channel.
```
 
Problem is PR isn't using consistent casing in filenames.
```
$ git status
Untracked files:
  (use "git add <file>..." to include in what will be committed)
        specification/powerbidedicated/resource-manager/Microsoft.PowerBIDedicated/
 
$ ls specification/powerbidedicated/resource-manager
Microsoft.PowerBIdedicated  readme.go.md  readme.nodejs.md  readme.typescript.md
Microsoft.PowerBIDedicated  readme.md     readme.python.md
```

# Two kinds of extension resource

**Category: Arm Resource Manager(ARM) Template**

## question 
I'm preparing documents related to extension resource for our customers. We seem to have two ways to represent extension resource.
1. `@extensionResource` directly on whatever resource model.
2. Directly use `Azure.ResourceManager.ExtensionResource`. This way, the resource model cannot be a tracked resource. Correct me if I'm wrong.

I feel like option 1 suffices, and it should be the recommended way? 
My thinking is, I don't want to write such lines in the documentation like: if it is not tracked resource, use `Azure.ResourceManager.ExtensionResource`, otherwise you should use `@extensionResource`. I just want to write something like: just use `@extensionResource` to mark an extension resource.

## answer
Talked offline, the `Azure.ResourceManager.ExtensionResource` is the recommended way. Even the resource model has the same properties as those in `TrackedResource`, we still should use `ExtensionResource` because `resourceKind` matters when service side calls `resolveArmResources`.

# Does TypeSpec have the option to achieve mutually exclusive?

**Category: Decorators**

## question 
We have 2 properties `awsCloudProfile`and `gcpCloudProfilein` our preperties in our typespec update. These 2 properties are mutually exclusive(ensuring that only one of `awsCloudProfile` or `gcpCloudProfile` can exist at a time). Besides setting both of them to optional, is there any other options in TypeSpec that we can achieve the mutually exclusive without causing a breaking change? 

## answer
There isn't currently a built-in way in TypeSpec to enforce mutual exclusivity between properties like `awsCloudProfile` and `gcpCloudProfile`.

In your PR, you're making both properties optional ‚Äî but that‚Äôs actually a breaking change. Clients may have previously assumed that `awsCloudProfile` was always present, and now that constraint is being relaxed, which breaks existing behavior.

Azure's recommended pattern for such cases is to use **explicit discriminated unions** to simplify the client experience. That means defining a `CloudProfile` union with a `@discriminator("kind")` to clearly indicate which cloud provider the profile belongs to. For example:

```typescript
@discriminator("kind")
union CloudProfile {
  aws: AwsCloudProfile;
  gcp: GcpCloudProfile;
}

model AwsCloudProfile {
  kind: "aws";
  awsAccountId: string;
}

model GcpCloudProfile {
  kind: "gcp";
  projectProperties?: GcpProjectProperties;
  organizationProperties?: GcpOrganizationProperties;
  isOrganization?: boolean = false;
}
```

With this structure, your `CloudConnectorProperties` model just needs a single `cloudProfile` property. It allows you to support AWS, GCP, or any other provider in future API versions without breaking changes.

To clarify a few key points:

1. **Is the `kind` property set by the customer?**
   Yes, it appears on the wire. In some SDKs, the customer needs to set it explicitly; in others, it may be inferred by the SDK type system.

2. **Does `kind` already exist in your types?**
   No, it doesn‚Äôt. This change would be a breaking change ‚Äî but one that allows forward compatibility when adding more cloud providers.

3. **Would the `hostType` property still be needed?**
   No, it would become redundant if you adopt this `@discriminator` union pattern.

As a side note: TypeSpec has introduced a `@discriminated` decorator for unions, which supports more flexible patterns, but it is not yet supported by all SDK emitters. It‚Äôs under investigation and targeted for support around August. However, the `@discriminator` pattern (which you are using here) is already required to be supported by all SDK emitters and is safe to use today.

# Question regarding extendable union types

**Category: SDK Generation**

## question 
Hi API Spec Review team,
We are in the process of writing our first Typespec based GA documentation and I have a question regarding extendable unions.
It seems that from the following docs, that extendable unions (for example of base type "string"), allow for additional values to be accepted besides the provided ones:
https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-enum/
However, having looked at other RP's implementation of this, together with their published docs on MS learn, I can't see evidence of their extendibility, and can't understand how clients are supposed to know that the provided enumeration types are extendable.
 
 
For example, while the following union is marked as extendable in the codebase, I can't see how this gets translated to docs:
```
namespace DevCenterService {
    @doc("The operating system type.")
    union OsType {
        @doc("The Windows operating system.") 
        Windows: "Windows",
        string,
    }

    @doc("Indicates whether hibernate is supported and enabled, disabled, or unsupported by the operating system. Un
    union HibernateSupport {
        @doc("Hibernate is enabled.")
        Enabled: "Enabled",

        @doc("Hibernate is not enabled.")
        Disabled: "Disabled",

        @doc("Hibernate is not supported by the operating system.")
        OsUnsupported: "OsUnsupported",

        string,
    }
}
```

```
HibernateSupport
Enumeration
Indicates whether hibernate is supported and enabled, disabled, or unsupported by the operating system. Unknown hibernate support is represented as null.

Value	        Description
Disabled	        Hibernate is not enabled.
Enabled	        Hibernate is enabled.
OsUnsupported	   Hibernate is not supported by the operating system.
```

This is important to us as we have several fields who's values we would like to be able to extend over time (possibly even within the same version) and we don't want clients taking dependency on any closed set.
 
Thanks

## answer
I don't know how this is represented in api documentation, but the mechanism for how is the x-ms-enum extension that is emitted in Swagger, which is the same thing we do for swagger-based APIs.
 
This would also show up in the typing system of some SDK and CLI client SDKs (depending on the language typing capabilities)
 
This is certainly something you can put into the documentation comments for the particular property involved to guarantee that it is represented in docs.
 
One thing - there is currently no type distinction between extensible unions that can add values within the current api-version, and those that would only add new values in new api-versions, so that is something you should make clear in property documentation.
 
Here is the onboarding page for API Documentation in the Azure SDK Portal: [Publish REST API reference docs](https://eng.ms/docs/products/azure-developer-experience/design/api-docs)
 
This includes a link to the channel for the docs team: https://teams.microsoft.com/dl/launcher/launcher.html?url=%2F_%23%2Fl%2Fchannel%2F19%3A7506cc3e220f430ab89d992c7db5284f%40thread.skype%2FAPI%2520Reference%2520and%2520Samples%3FgroupId%3Dde9ddba4-2574-4830-87ed-41668c07a1ca%26tenantId%3D72f988bf-86f1-41af-91ab-2d7cd011db47&type=channel&deeplinkId=4d931d59-a8ff-489e-a010-100f7f950bd6&directDl=true&msLaunch=true&enableMobilePage=true&suppressPrompt=true

# Record<Element> type

**Category: Decorators**

## question 
I have a query regarding the use of the `Record<Element>` data type in a model property. I added a [new property](https://github.com/Azure/azure-rest-api-specs-pr/pull/22910/files#diff-b253b1be6cda9df6d9c4267f19fcd7e37c4f6579d0bc76094ca7e74d45b75140R25:~:text=newValue%3F%3A%20Record%3Cstring%3E%3B) in the CloudSprout Resource Provider with the type `Record<string>`, but I‚Äôm encountering the following [typespec validation error](https://github.com/Azure/azure-rest-api-specs-pr/actions/runs/15398776056/job/43326031901?pr=22910):

```
specification/azcis/Cloudsprout.Management/sharedConfigValues.tsp:25:3 - error @azure-tools/typespec-azure-resource-manager/arm-no-record: Model properties or operation parameters should not be of type Record. ARM requires Resource provider teams to define types explicitly.
603> 25 |   newValue?: Record<string>;
604       |   ^^^^^^^^
605  
606  Found 1 error.
```
Does this mean that `Record<Element>` is not supported? I checked the [azure-rest-api-specs-pr](https://github.com/search?q=repo%3AAzure%2Fazure-rest-api-specs-pr+string+%7C+Record&type=code) repo and noticed that this type is used in a few places.
```

specification/dns/DNS.Management/RecordSet.tsp

 * Describes a DNS record set (a collection of DNS records with the same name and type).
@Azure.ResourceManager.Private.armResourceInternal(RecordSetProperties)
model RecordSet extends Foundations.ProxyResource {
    Resource = RecordSet,
    KeyName = "relativeRecordSetName",
    SegmentName = "{recordType}",
   * The etag of the record set.
  etag?: string;
```
```
specification/ai/Azure.AI.Agents/common/models.tsp

  string,
  string,
  after?: string;
  before?: string;
  lastId?: string;
  id: string;
  metadata: Record<string> | null;
  metadata?: Record<string> | null;
```

Could you please confirm whether `Record<Element>` is a supported type? If it is, could you please help why it‚Äôs failing in the TypeSpec file for CloudSprout RP? Am I missing something?

## answer
this is just a warning(that shows as error due to `--warn-as-error` flag) that can be suppressed if you have a legitimate use for it that was approved by the review board https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/rules/arm-no-record/#_top

# relaxing a pattern across versions

**Category: Versioning**

## question 
We released a preview version of our API and found that the pattern being enforced on some of the model properties was too restrictive.  We wanted to relax them, but it doesn't seem I can do that with the added/removed decorators unless I change the name of the property.  Is there anything I'm missing or this is how it must be done?
```
@removed(Microsoft.IoTFirmwareDefense.Versions.v2025_06_01)
@doc("Firmware vendor.")
@pattern("^[a-zA-Z0-9][a-zA-Z0-9-_.,'\"~=(){}:]*$")
vendor?: string;

You, 1 second ago ¬∑ Uncommitted changes

@added(Microsoft.IoTFirmwareDefense.Versions.v2025_06_01)
@doc("Firmware vendor.")
vendor?: string;    Model already has a property named vendor
```

## answer
The first question is:  are you relaxing this pattern across all api-versions in your service, or just the new api-version?
 
Generally speaking, patterns are not used by our client SDKs, and it is important for specs to be accurate to service behavior, so this kind of breaking change in the spec is generally allowed, if it really describes service behavior.
 
It is possible to do this, but it involves a remove/rename/replace pattern,  as in this playground.
 
The reason you have to do this is that in typespec, collections like Namespace or Model or Interface use the name of included types as their identifier, so you need two different names for these types.  In this case, you need two different model properties, and you cna use the renaming trick to remove and rename one and add the other in the version where the change is made, and ensure that the original property still has the correct name in previous versions.
 
However, if your service uses the new pattern across all api-versions, then it is best for your spec to reflect this.

it is generally better for review to isolate a change like this so it's easy to talk about it separately

# Duplicate model definition errors on compilation with TypeSpec Compiler v1.0.0 - Microsoft.Mission

**Category: TypeSpec Validation**

## question 
I am working on this PR [Add Microsoft.Mission version 2025-05-01-preview by tgoodyear ¬∑ Pull Request #22581 ¬∑ Azure/azure-rest-api-specs-pr](https://github.com/Azure/azure-rest-api-specs-pr/pull/22581) and after the TypeSpec compiler and dependency bumps a couple weeks ago, I am getting compilation errors regarding `duplicate-type-name` for multiple models and unions. I also receive an error about a UnionVariant requiring `@doc`, but it is clearly in the source. None of these errors or warnings occur on 1.0.0-rc.1.
 
The last commit involving package.json and package-lock.json that works is [[shared\] Add SpecModel (#33362) ¬∑ Azure/azure-rest-api-specs-pr@3fcf376](https://github.com/Azure/azure-rest-api-specs-pr/commit/3fcf37699e1c8687141725d630f027c2623087e1), this includes `"@typespec/compiler": "1.0.0-rc.1"` 
 
I've checked the breaking changes for TypeSpec v1.0.0 as compared to 1.0.0-rc.1 and don't see anything relevant for my spec.
 
Anyone else experiencing similar issues? Full errors below and available at the [TypeSpec Validation check for the PR](https://github.com/Azure/azure-rest-api-specs-pr/actions/runs/15098397916/job/42436108953?pr=22581).
```
Executing rule: Compile
  execFile("npm", ["exec","--no","--","tsp","compile","--list-files","--warn-as-error","/home/runner/work/azure-rest-api-specs-pr/azure-rest-api-specs-pr/specification/mission/Mission.Management"])
  TypeSpec compiler v1.0.0
  
  Diagnostics were reported during compilation:
  
  specification/mission/Mission.Management/resourcetypes/catalog/catalog.tsp:31:3 - error @azure-tools/typespec-azure-core/documentation-required: The UnionVariant named 'blob' should have a documentation or description, use doc comment /** */ to provide it.
  > 31 |   blob: BlobCatalog,
       |   ^^^^
  specification/mission/Mission.Management/resourcetypes/shared/governedserviceitem.tsp:55:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'GovernedServiceItem'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 55 | model GovernedServiceItem {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:10:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitHubState'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 10 | union TransitHubState {
       |       ^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:53:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOption'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 53 | model TransitOption {
       |       ^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/enclaveEndpoint/enclaveEndpoint.tsp:36:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'EnclaveEndpointDestinationRule'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 36 | model EnclaveEndpointDestinationRule {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:59:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'CommunityEndpointDestinationRule'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 59 | model CommunityEndpointDestinationRule {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/virtualEnclave/virtualenclave.tsp:32:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'SubnetConfiguration'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 32 | model SubnetConfiguration {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/principal.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'Principal'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | model Principal {
      |       ^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/governedserviceitem.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ServiceIdentifier'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | union ServiceIdentifier {
      |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:30:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOptionType'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 30 | union TransitOptionType {
       |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:44:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOptionParams'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 44 | model TransitOptionParams {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/enclaveEndpoint/enclaveEndpoint.tsp:13:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'EnclaveEndpointProtocol'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 13 | union EnclaveEndpointProtocol {
       |       ^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:42:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'DestinationType'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 42 | union DestinationType {
       |       ^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:13:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'CommunityEndpointProtocol'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 13 | union CommunityEndpointProtocol {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/roleassignmentitem.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'RoleAssignmentItem'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | model RoleAssignmentItem {
      |       ^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/governedserviceitem.tsp:55:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'GovernedServiceItem'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 55 | model GovernedServiceItem {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:10:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitHubState'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 10 | union TransitHubState {
       |       ^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:53:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOption'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 53 | model TransitOption {
       |       ^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/enclaveEndpoint/enclaveEndpoint.tsp:36:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'EnclaveEndpointDestinationRule'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 36 | model EnclaveEndpointDestinationRule {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:59:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'CommunityEndpointDestinationRule'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 59 | model CommunityEndpointDestinationRule {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/approvals/approvals.tsp:65:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'Approver'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 65 | model Approver {
       |       ^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/principal.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'Principal'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | model Principal {
      |       ^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/virtualEnclave/virtualenclave.tsp:32:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'SubnetConfiguration'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 32 | model SubnetConfiguration {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/governedserviceitem.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ServiceIdentifier'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | union ServiceIdentifier {
      |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/community/community.tsp:31:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ApprovalPolicy'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 31 | union ApprovalPolicy {
       |       ^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/community/community.tsp:43:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'MandatoryApprover'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 43 | model MandatoryApprover {
       |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:30:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOptionType'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 30 | union TransitOptionType {
       |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:44:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOptionParams'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 44 | model TransitOptionParams {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/enclaveEndpoint/enclaveEndpoint.tsp:13:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'EnclaveEndpointProtocol'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 13 | union EnclaveEndpointProtocol {
       |       ^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:42:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'DestinationType'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 42 | union DestinationType {
       |       ^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:13:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'CommunityEndpointProtocol'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 13 | union CommunityEndpointProtocol {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/approvals/approvals.tsp:32:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ActionPerformedEnum'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 32 | union ActionPerformedEnum {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/roleassignmentitem.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'RoleAssignmentItem'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | model RoleAssignmentItem {
      |       ^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/governedserviceitem.tsp:55:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'GovernedServiceItem'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 55 | model GovernedServiceItem {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:10:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitHubState'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 10 | union TransitHubState {
       |       ^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:53:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOption'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 53 | model TransitOption {
       |       ^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/enclaveEndpoint/enclaveEndpoint.tsp:36:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'EnclaveEndpointDestinationRule'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 36 | model EnclaveEndpointDestinationRule {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:59:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'CommunityEndpointDestinationRule'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 59 | model CommunityEndpointDestinationRule {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/approvals/approvals.tsp:65:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'Approver'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 65 | model Approver {
       |       ^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/principal.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'Principal'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | model Principal {
      |       ^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/shared/governedserviceitem.tsp:5:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ServiceIdentifier'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 5 | union ServiceIdentifier {
      |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/virtualEnclave/virtualenclave.tsp:32:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'SubnetConfiguration'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 32 | model SubnetConfiguration {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/community/community.tsp:31:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ApprovalPolicy'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 31 | union ApprovalPolicy {
       |       ^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/community/community.tsp:43:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'MandatoryApprover'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 43 | model MandatoryApprover {
       |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:30:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOptionType'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 30 | union TransitOptionType {
       |       ^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/transitHub/transitHub.tsp:44:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'TransitOptionParams'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 44 | model TransitOptionParams {
       |       ^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/enclaveEndpoint/enclaveEndpoint.tsp:13:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'EnclaveEndpointProtocol'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 13 | union EnclaveEndpointProtocol {
       |       ^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:42:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'DestinationType'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 42 | union DestinationType {
       |       ^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/communityEndpoint/communityEndpoint.tsp:13:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'CommunityEndpointProtocol'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 13 | union CommunityEndpointProtocol {
       |       ^^^^^^^^^^^^^^^^^^^^^^^^^
  specification/mission/Mission.Management/resourcetypes/approvals/approvals.tsp:32:7 - error @typespec/openapi/duplicate-type-name: Duplicate type name: 'ActionPerformedEnum'. Check @friendlyName decorators and overlap with types in TypeSpec or service namespace.
  > 32 | union ActionPerformedEnum {
       |       ^^^^^^^^^^^^^^^^^^^
  
  Found 50 errors.
```

## answer
This is a bug, but there are a couple of things you are doing here you probably want to avoid as well:
Don't use the transformation decorators (like `@withoutDefaultProperties`) directly 
Don't use the transformation templates without giving the transformed object a name (as in `properties?: Update<CommunityPatchProperties>;`)
Here is a playground showing how this can be worked around (and you can end up with slightly better names)
[Here is a playground](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvcmVzdCI7CtIZaHR0cNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwp1c2luZyBBxB8uQ29yZc4SUscxTcYwyB1UeXBlU3BlYy5IdHRw0RVSZXN00RVW6QDXOwpA5wDkZWQoxxdzKQpAZG9jKCJNaWNyb3NvZnQgTWlzxBog6ACDIFByb3ZpZGVyIOYAvW1lbnQgQVBJLiIpCkBhcm3IH05hbWVzcGFjZctNLsdNxCtzZXJ2aWNlKCN7IHRpdGxlOiDTKCB9KQpuyEkg0SA75wCuU3Vw5AF1ZWTkAIkg5wDWcyBmb3IgdGjTOCDoAYEgcOcAruQAvmVudW0g6AEJIHsKICDGXlRoZSAyMDI0LTA2LTAxLXByZXZpZXfIZ8Q6ICDkAPpDb21tb27kAWpzx0YoInY1xh%2FHEWluZy51c2VEZXBlbmRlbmN5KPUB4OgBpnMudjFfMF9QxnJfMd9L6QI910AyxEB25ADLXzA2XzAxX%2BcAyzogIvIA4CIsCn3nAV9Hb3Zlcm5lZFPmAbNJdGVt5AIGcGVydGllcyIpCm1vZGVsINQn6gFGxxYgSUTlARJpZDogc3Ry5QKIyGjkAUF1bml0ee0CbdBnySZCYXNlTcUTymblAn7nAR8gc3RhdGXnAaDEFmJpbGl0eShMaWZlY3ljbOQBd2FkxB7lAgbHNlPENT866QCDzFLFHDsKyW5MaXN0IG9mIOcCzHMgZ%2BcBAyBieSBhIGPoAKrmAITIHecBCsQ9OvQBNVtdID0gI1sje%2BUBJSIxMjMiIH1d%2FwEn6AEnIHdpdGhvdXQgZGVmYXVsdCB2YWx19AE%2BUGF0Y2jKOOQBk3MgVXBkYXRlYWJs5AD3xxo8T21pdETGTnM88gF%2BPj7oA4fJHCDFXekAn9d98AG80D9w7AH85QGlxw8%2FOvkAx%2BUBnS4uLvYDV0ZvdW5kYXTlAxpBcm1UYWdzxzt59AFf5gCh%2BgDGyBrkATpUcmFja2VkyBP0ASjmAOtrZXkoIukCGuQFJuYCoXNlZ%2BQFS8oc6AD4QHBhdHRlcm4oIl5bYS16QS1aXccIMC05LV0qyg1dJMkxaO0EvuQFQ%2BQCqOQFDcl76QC%2ByAnFPcQr%2FAOaSW50ZXJmYcUu5AT1yD1PcGVy5gFaCmnII%2BoBKuUA%2B2dldOQBKkHKNeQDgOoBKsgWPjvkAL11c2VGaW5hbOUDdFZpYSgi5gc8YXN5bmMt5AG1xW%2FlALVjcmVhdGVPcuYCv89lQ8cdUmVwbGFjZUHEQDwKICAg8gHJLMUXTHJvSGVhZGVycyA96weS7QI%2BUmV0cnlBZnRlcsYrICbFOyDEecVi6QEQxiAKICDlANd17ACiQ3VzdG9t5QLC%2FwCWICDmAxTmApI99ANJyGJkZWxl8QEERMUVV%2BYEG09rxm7RacVAbGlzdELJE0dyb3Vwz03kBLlCeVBhcmVudN1FU3Vic2NyaXDkAQfHRMY8zBnVQn3rAkXqAlogZXh0ZW5kc%2FYJFS7LKXt9Cg%3D%3D&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D) showing how this can be worked around (and you can end up with slightly better names)
```
import "@typespec/rest";
import "@typespec/http";
import "@typespec/versioning";
import "@azure-tools/typespec-azure-core";
import "@azure-tools/typespec-azure-resource-manager";
using Azure.Core;
using Azure.ResourceManager;
using TypeSpec.Http;
using TypeSpec.Rest;
using TypeSpec.Versioning;
@versioned(Versions)
@doc("Microsoft Mission Resource Provider management API.")
@armProviderNamespace("Microsoft.Mission")
@service(#{ title: "Microsoft.Mission" })
namespace Microsoft.Mission;
@doc("Supported API versions for the Microsoft.Mission resource provider.")
enum Versions {
  @doc("The 2024-06-01-preview version.")
  @armCommonTypesVersion("v5")
  @Versioning.useDependency(Azure.ResourceManager.Versions.v1_0_Preview_1)
  @Versioning.useDependency(Azure.Core.Versions.v1_0_Preview_2)
  v2024_06_01_preview: "2024-06-01-preview",
}
@doc("GovernedServiceItem Properties")
model GovernedServiceItem {
  @doc("Service ID")
  id: string;
}
@doc("Community Resource Properties")
model CommunityBaseModel {
  @doc("Provisioning state.")
  @visibility(Lifecycle.Read)
  provisioningState?: ResourceProvisioningState;

  @doc("List of services governed by a community.")
  governedServiceList: GovernedServiceItem[] = #[#{ id: "123" }];
}
@doc("Community Resource Properties without default values")
model CommunityPatchProperties
  is UpdateableProperties<OmitDefaults<CommunityBaseModel>>;
@doc("Community Patch Resource")
model CommunityPatchModel {
  @doc("Community Patch properties")
  properties?: CommunityPatchProperties;

  ...Azure.ResourceManager.Foundations.ArmTagsProperty;
}
@doc("Community Model Resource")
model CommunityResource is TrackedResource<CommunityBaseModel> {
  @key("communityName")
  @segment("communities")
  @pattern("^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$")
  @path
  @doc("The name of the communityResource Resource")
  name: string;
}
@doc("Community Interface")
@armResourceOperations
interface Community {
  get is ArmResourceRead<CommunityResource>;
  @useFinalStateVia("azure-async-operation")
  createOrUpdate is ArmResourceCreateOrReplaceAsync<
    CommunityResource,
    LroHeaders = Azure.Core.Foundations.RetryAfterHeader &
      ArmAsyncOperationHeader
  >;
  update is ArmCustomPatchAsync<
    CommunityResource,
    PatchModel = CommunityPatchModel
  >;
  delete is ArmResourceDeleteWithoutOkAsync<CommunityResource>;
  listByResourceGroup is ArmResourceListByParent<CommunityResource>;
  listBySubscription is ArmListBySubscription<CommunityResource>;
}
interface Operations extends Azure.ResourceManager.Operations {}
```

# Upper case in action segment

**Category: Operations**

## question 
Last time I confirmed that route is case sensitive. Now I have a customer whose route is like
```
/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ContosoProviderHub
```
`/employees/{employeeName}/All`. The action segment is capitalized. I tried [this](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIsdXyC1IdWJDbGllbnQiIH0pCkDnAUNlZCjnAL9zKQpuyFAgTWljcm9zb2Z0LtJG7wC2QVBJIMdNc%2BQAoWVudW3oARNzIHsKICDELjIwMjEtMTAtMDEtcHJldmlld8g1xDQgIEB1c2VEZXBlbmRlbmN5KPUBLy7IVi52MV8wX1DGSF8xKcRAYXJtQ29tbW9uVOQBz8cq10jLKctUNcRIYPIAqWAsCn3mAPNB6AD16wEOIOgCMOQAyG1vZGVsIEVtcGxveWVlIGlzIFRyYWNrZWToAII8yBxQcm9wZXJ0aWVzPuUBJC4u6QCm5AHWUGFyYW1ldGVyyTE%2BO%2BgAhslfcMlE0nzKYOkBg0FnZSBvZiBlyD%2FlAXhhZ2U%2FOiBpbnQzMjsKxylDaXR50ipjaXR5Pzogc3Ry5QLpxyxQcm9maWzTWUBlbmNvZGUoImJhc2U2NHVybCLkAWBwxjA%2FOiBieXRlc8lIVGhlIHN0YXR1c8RLdGhlIGxhc3Qg5ADFYXRpb27lAvwgIEB2aXNpYmlsaXR5KExpZmVjeWNs5AHgYWTHXcQg5QOLU3RhdMRn5QGrzBTpAUjEc8wy5QCA5QDKYekB1cV3QGxyb8Q7dXMKdW7kArLRVOUBZOYBGizsANLIRyBjcmXEJ3JlcXVlc3QgaGFzIGJlZW4gYWNjZXB0ZWTEZyAgQccOOiAiyAsi1lBpxEDkALTpAMHIROwAnDogIswP2kx1cGRhdMRPxUNVxw46ICLIC8o76QSl6QDE5gDcZOcBolN1Y2NlZWTlAMXJDNM%2FxTbkAU1mYWlsyT5GxQ06ICLGCdw4d2FzIGNhbmNlyj5Dxw%2FkBP3HC%2F8BQCBkZWxl6QGARMQN5gD5yAsi6QP96QN3bW926gHK6QN5TW92ZVLHFegDcsRzbW92xGhmcm9tIGxvY%2BYAvMVuxBPxA1DLM3RvzzF0b8ov9wCVc3BvbnPrBIvmAJbHFuwAl%2B4DbMU%2BxWTGfOYC7s1uaW50ZXJm5AYcT%2BgDlHMgZXh0ZW5kc%2FYG3i7LKXt9CuUGusgjyhvLWegAzeQEs%2BgEtCBzYW1wbOsBumFjxDcgdGhhdOYAt%2BkEd3RvIGRpZmZlcuQHL%2B4BOkDGNigiQWzmBIfFOmlzIEHqAJNBxSNTeW5j6QV0LOwB1sgN5gFNPjsKCn0K&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D). Seems not work.
```
import "@typespec/http";
import "@typespec/rest";
import "@typespec/versioning";
import "@azure-tools/typespec-azure-core";
import "@azure-tools/typespec-azure-resource-manager";

using Http;
using Rest;
using Versioning;
using Azure.Core;
using Azure.ResourceManager;

/** Contoso Resource Provider management API. */
@armProviderNamespace
@service(#{ title: "ContosoProviderHubClient" })
@versioned(Versions)
namespace Microsoft.ContosoProviderHub;

/** Contoso API versions */
enum Versions {
  /** 2021-10-01-preview version */
  @useDependency(Azure.ResourceManager.Versions.v1_0_Preview_1)
  @armCommonTypesVersion(Azure.ResourceManager.CommonTypes.Versions.v5)
  `2021-10-01-preview`,
}

/** A ContosoProviderHub resource */
model Employee is TrackedResource<EmployeeProperties> {
  ...ResourceNameParameter<Employee>;
}

/** Employee properties */
model EmployeeProperties {
  /** Age of employee */
  age?: int32;

  /** City of employee */
  city?: string;

  /** Profile of employee */
  @encode("base64url")
  profile?: bytes;

  /** The status of the last operation. */
  @visibility(Lifecycle.Read)
  provisioningState?: ProvisioningState;
}

/** The provisioning state of a resource. */
@lroStatus
union ProvisioningState {
  string,

  /** The resource create request has been accepted */
  Accepted: "Accepted",

  /** The resource is being provisioned */
  Provisioning: "Provisioning",

  /** The resource is updating */
  Updating: "Updating",

  /** Resource has been created. */
  Succeeded: "Succeeded",

  /** Resource creation failed. */
  Failed: "Failed",

  /** Resource creation was canceled. */
  Canceled: "Canceled",

  /** The resource is being deleted */
  Deleting: "Deleting",
}

/** Employee move request */
model MoveRequest {
  /** The moving from location */
  from: string;

  /** The moving to location */
  to: string;
}

/** Employee move response */
model MoveResponse {
  /** The status of the move */
  movingStatus: string;
}

interface Operations extends Azure.ResourceManager.Operations {}

@armResourceOperations
interface Employees {

  /** A sample resource action that move employee to different location */
  @action("All")
  move is ArmResourceActionSync<Employee, MoveRequest, MoveResponse>;

}
```

## answer
For ARM APIs, segments are mandated to be case insensitive, so this should not be an issue for ARM APIs.  Does seem like an issue for `@action` in general, though.
Note that you can use the private decorator `@Rest.Private.actionSegment` to get around the normalization done by `@action`  [like this](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIsdXyC1IdWJDbGllbnQiIH0pCkDnAUNlZCjnAL9zKQpuyFAgTWljcm9zb2Z0LtJG7wC2QVBJIMdNc%2BQAoWVudW3oARNzIHsKICDELjIwMjEtMTAtMDEtcHJldmlld8g1xDQgIEB1c2VEZXBlbmRlbmN5KPUBLy7IVi52MV8wX1DGSF8xKcRAYXJtQ29tbW9uVOQBz8cq10jLKctUNcRIYPIAqWAsCn3mAPNB6AD16wEOIOgCMOQAyG1vZGVsIEVtcGxveWVlIGlzIFRyYWNrZWToAII8yBxQcm9wZXJ0aWVzPuUBJC4u6QCm5AHWUGFyYW1ldGVyyTE%2BO%2BgAhslfcMlE0nzKYOkBg0FnZSBvZiBlyD%2FlAXhhZ2U%2FOiBpbnQzMjsKxylDaXR50ipjaXR5Pzogc3Ry5QLpxyxQcm9maWzTWUBlbmNvZGUoImJhc2U2NHVybCLkAWBwxjA%2FOiBieXRlc8lIVGhlIHN0YXR1c8RLdGhlIGxhc3Qg5ADFYXRpb27lAvwgIEB2aXNpYmlsaXR5KExpZmVjeWNs5AHgYWTHXcQg5QOLU3RhdMRn5QGrzBTpAUjEc8wy5QCA5QDKYekB1cV3QGxyb8Q7dXMKdW7kArLRVOUBZOYBGizsANLIRyBjcmXEJ3JlcXVlc3QgaGFzIGJlZW4gYWNjZXB0ZWTEZyAgQccOOiAiyAsi1lBpxEDkALTpAMHIROwAnDogIswP2kx1cGRhdMRPxUNVxw46ICLIC8o76QSl6QDE5gDcZOcBolN1Y2NlZWTlAMXJDNM%2FxTbkAU1mYWlsyT5GxQ06ICLGCdw4d2FzIGNhbmNlyj5Dxw%2FkBP3HC%2F8BQCBkZWxl6QGARMQN5gD5yAsi6QP96QN3bW926gHK6QN5TW92ZVLHFegDcsRzbW92xGhmcm9tIGxvY%2BYAvMVuxBPxA1DLM3RvzzF0b8ov9wCVc3BvbnPrBIvmAJbHFuwAl%2B4DbMU%2BxWTGfOYC7s1uaW50ZXJm5AYcT%2BgDlHMgZXh0ZW5kc%2FYG3i7LKXt9CuUGusgjyhvLWegAzeYEs2dldOQBp0HKNeQD5%2BwFECDnAntPcuUCp%2BUB1ssvQ8cdUmVwbGFjZUFzeW5jzj%2FlAvfIN0N1c3RvbVBhdGNoU8QqCiAgIOkAkyzFDvYA50ZvdW7kAybkBkXIHOYAkU3kAYTGSdBLyhDqBarFGT4KICDlAJ3mAprvANTlApdlV2l0aG91dE9r8wDUbGlzdEJ5yDBHcm91cM9ETMUiUGFyZW501DxTdWJzY3JpcOUCecY7xjPMGcw56AZgIHNhbXBs6wNmYWPFRHRoYXTmAmPpBiN0byBkaWZmZeQAhO8C5kDkCVsuUHJpdmF0ZS7GQ1NlZ%2BQJBSgiQWzmBkfFTu4A10HGKuwBESzsA5bIDeYDDfMAt0hFQUTqBnHkAKNjaGVja%2BoAz2V4aXN0ZW7mB%2Bsgxh5FyRTvAn3NHe4Hxg%3D%3D&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D). 
```
interface Operations extends Azure.ResourceManager.Operations {}

@armResourceOperations
interface Employees {
  get is ArmResourceRead<Employee>;
  createOrUpdate is ArmResourceCreateOrReplaceAsync<Employee>;
  update is ArmCustomPatchSync<
    Employee,
    Azure.ResourceManager.Foundations.ResourceUpdateModel<
      Employee,
      EmployeeProperties
    >
  >;
  delete is ArmResourceDeleteWithoutOkAsync<Employee>;
  listByResourceGroup is ArmResourceListByParent<Employee>;
  listBySubscription is ArmListBySubscription<Employee>;

  /** A sample resource action that move employee to different location */
  @Rest.Private.actionSegment("All")
  move is ArmResourceActionSync<Employee, MoveRequest, MoveResponse>;

  /** A sample HEAD operation to check resource existence */
  checkExistence is ArmResourceCheckExistence<Employee>;
}
```
I don't think there will be a need for this in ARM APIs

# We cannot customize the Type for ResourceNameParameter?

**Category: Arm Resource Manager(ARM) Template**

## question 
Like [this](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIsdXyC1IdWJDbGllbnQiIH0pCkDnAUNlZCjnAL9zKQpuyFAgTWljcm9zb2Z0LtJG7wC2QVBJIMdNc%2BQAoWVudW3oARNzIHsKICDELjIwMjEtMTAtMDEtcHJldmlld8g1xDQgIEB1c2VEZXBlbmRlbmN5KPUBLy7IVi52MV8wX1DGSF8xKcRAYXJtQ29tbW9uVOQBz8cq10jLKctUNcRIYPIAqWAsCn3mAPNB6AD16wEOIOgCMOQAyG1vZGVsIEVtcGxveWVlIGlzIFRyYWNrZWToAII8yBxQcm9wZXJ0aWVzPuUBJC4u6QCm5AHWUGFyYW1ldGVyyTEsIOQAsCA9IFRlc3QsIMYldHRlcm4gPSAiIj475ACldW7kAVHEIsVVIkEiLCAiQiLoAMDITCBwyX7yALbqAJrpAb1BZ2Ugb2YgZcg%2F5QGyYWdlPzogaW50MzI7CscpQ2l0edIqY2l0eT86IHN0cuUDI8csUHJvZmls01lAZW5jb2RlKCJiYXNlNjR1cmwi5AGacMYwPzogYnl0ZXPJSFRoZSBzdGF0dXPES3RoZSBsYXN0IOQAxWF0aW9u5QM2ICBAdmlzaWJpbGl0eShMaWZlY3ljbOQCGmFkx13EIOUDxVN0YXTEZ%2BUB5cwU5QFjyHPMMuUAgOUAymHpAg%2FFd0Bscm%2FEO3Vz5wGb0VTlAWTmARos7ADSyEcgY3JlxCdyZXF15AHXaGFzIGJlZW4gYWNjZXB0ZWTEZyAgQccOOiAiyAsi1lBpxEDkALTpAMHIROwAnDogIswP2kx1cGRhdMRPxUNVxw46ICLIC8o76QTf6QDE5gDcZOcBolN1Y2NlZWTlAMXJDNM%2FxTbkAU1mYWlsyT5GxQ06ICLGCdw4d2FzIGNhbmNlyj5Dxw%2FkBTfHC%2F8BQCBkZWxl6QGARMQN5gD5yAsi6QQ36QN3bW926gHK6QN5TW92ZVLHFegDcsRzbW92xGhmcm9tIGxvY%2BYAvMVuxBPxA1DLM3RvzzF0b8ov9wCVc3BvbnPrBMXmAJbHFuwAl%2B4DbMU%2BxWTGfOYC7s1uaW50ZXJm5AZWT%2BgDlHMgZXh0ZW5kc%2FYHGC7LKXt9CuUG9MgjyhvLWegAzeYEs2dldOQBp0HKNeQD5%2BkFSj475ASU5QJ7T3LlAqflAdbLL0PHHVJlcGxhY2VBc3luY84%2F5QL3yDdDdXN0b21QYXRjaFPEKgogICDpAJMsxQ72AOdGb3Vu5AMm5AZ%2FyBzmAJFN5AGEyXMs8wWdPgogIOUAi%2BYCiO8AwuUChWVXaXRob3V0T2vzAMJsaXN0QnnIMEdyb3Vwz0RMxSJQYXJlbnTUPFN1YnNjcmlw5QJnxjvGM8wZzDnoBk4gc2FtcGzrA1RhY8VEdGhhdOYCUekGEXRvIGRpZmZl5ACE7wLUxSnuALJBxUjlAYTIdyzsA1%2FIDeYC1vMAkkhFQUTqBjrEfmNoZWNr6gCqZXhpc3RlbuYH7iDGHkXJFO8CRs0d7AEJfQo%3D&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D), 
```
/** Contoso Resource Provider management API. */
@armProviderNamespace
@service(#{ title: "ContosoProviderHubClient" })
@versioned(Versions)
namespace Microsoft.ContosoProviderHub;

/** Contoso API versions */
enum Versions {
  /** 2021-10-01-preview version */
  @useDependency(Azure.ResourceManager.Versions.v1_0_Preview_1)
  @armCommonTypesVersion(Azure.ResourceManager.CommonTypes.Versions.v5)
  `2021-10-01-preview`,
}

/** A ContosoProviderHub resource */
model Employee is TrackedResource<EmployeeProperties> {
  ...ResourceNameParameter<Employee, Type = Test, NamePattern = "">;
}

union Test {
  "A", "B"
}

/** Employee properties */
model EmployeeProperties {
  /** Age of employee */
  age?: int32;

  /** City of employee */
  city?: string;

  /** Profile of employee */
  @encode("base64url")
  profile?: bytes;

  /** The status of the last operation. */
  @visibility(Lifecycle.Read)
  provisioningState?: ProvisioningState;
}

/** The provisioning state of a resource. */
@lroStatus
union ProvisioningState {
  string,

  /** The resource create request has been accepted */
  Accepted: "Accepted",

  /** The resource is being provisioned */
  Provisioning: "Provisioning",

  /** The resource is updating */
  Updating: "Updating",

  /** Resource has been created. */
  Succeeded: "Succeeded",

  /** Resource creation failed. */
  Failed: "Failed",

  /** Resource creation was canceled. */
  Canceled: "Canceled",

  /** The resource is being deleted */
  Deleting: "Deleting",
}

/** Employee move request */
model MoveRequest {
  /** The moving from location */
  from: string;

  /** The moving to location */
  to: string;
}

/** Employee move response */
model MoveResponse {
  /** The status of the move */
  movingStatus: string;
}

interface Operations extends Azure.ResourceManager.Operations {}

@armResourceOperations
interface Employees {
  get is ArmResourceRead<Employee>;
  createOrUpdate is ArmResourceCreateOrReplaceAsync<Employee>;
  update is ArmCustomPatchSync<
    Employee,
    Azure.ResourceManager.Foundations.ResourceUpdateModel<Employee, EmployeeProperties>
  >;
  delete is ArmResourceDeleteWithoutOkAsync<Employee>;
  listByResourceGroup is ArmResourceListByParent<Employee>;
  listBySubscription is ArmListBySubscription<Employee>;

  /** A sample resource action that move employee to different location */
  move is ArmResourceActionSync<Employee, MoveRequest, MoveResponse>;

  /** A sample HEAD operation to check resource existence */
  checkExistence is ArmResourceCheckExistence<Employee>;
}
```
it throws "Cannot apply @pattern decorator to type it is not a string". Look like a bug?
```
model Employee is TrackedResource<EmployeeProperties> {
  ...ResourceNameParameter<Employee, Type = Test, NamePattern = "">;
}

union Test {
  "A", "B"
}
```

## answer
As we discussed in this issue: [List resources with two different resources but same resource type ¬∑ Issue #1911 ¬∑ Azure/typespec-azure](https://github.com/Azure/typespec-azure/issues/1911)  You can handle this [like this](https://azure.github.io/typespec-azure/playground/?c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIkRpYWdub3N0aWNzQ2xpZW50IiB9KQpA5wE8ZWQo5wC4cykKbshJIE1pY3Jvc29mdC7LP%2B8AqEFQSSDHRnPkAJNlbnVt6AEFcyB7CiAgxC4yMDIxLTEwLTAxLXByZXZpZXfINcQ0ICBAdXNlRGVwZW5kZW5jeSj1ASEuyFYudjFfMF9QxkhfMSnEQGFybUNvbW1vblTkAcHHKtdIyynLVDXESGDyAKlgLAp95gDzQegA9egBc0h1YiDoAiLlAY9sb2NhdGlvbshyCm1vZGVsIOoBPiBpcyBUcmFja2VkyCQ8yh5Qcm9wZXJ0aWVzPukBOlRoZSBkykDkAZ3EayAgI3N1cHByZXNz%2FwLC7wLCL2FybcoVxE8tcGF0dGVybiLkAUh2aXNpYmlsaXR5KExpZmVjeWNs5AFBYWTlAWZwYXRoxAhzZWfkAogoIuoAmnMixSJrZXnMFuQClcUZxGk66wEJxBlzO%2BkBWmxsb3dlZMUmcyBmb3LrAPPlAlZ1buQCK88%2F6QEkQSBzcG90IHJlcGxhY%2BYDInJlY29tbeQCUMxMxEsgIFNwb3RSyixSyis6ICLEStYdIiwKyXBkaXNrSW7kAWfkAe%2FRYkTNHzogIs4wxkpzdHJpbmfpAl5FbXBsb3llZSBw6QIGxE3wAkLqAiTqAP9nZSBvZiBlyEHlAINhZ2U%2FOiBpbnQzMjvoALhDaXR50ipjaXR5PzrnAI%2FJLFByb2ZpbNNZQGVuY29kZSgiYmFzZTY0dXJs5QHhcMYwPzogYnl05AHb6wLAc3RhdHVzxEt0aGUgbGFzdCDkAMXlAyvlBMj%2FAnnEXcQg5QVXU3RhdMRn5QOFzBTpAk7Ec8wy5QCA5QDKYekDr8V3QGxyb8Q7dXPnAmHRVOUBZOgBqesA0shHIGNyZcQncmVxdWVzdCBoYXMgYmVlbiBhY2NlcHRlZMRnICBBxw46ICLIC%2BoCTs1QacRA5AC06QDByETsAJw6ICLMD9pMdXBkYXTET8VDVccOOiAiyAvKO%2BkGcekAxOYA3GTnAaJTdWNjZWVk5QDFyQzTP8U25AFNZmFpbMk%2BRsUNOiAixgncOHdhcyBjYW5jZco%2BQ8cPOiAiyAv%2FAUAgZGVsZekBgETEDeYA%2BcgLIvIDeW1vduoByukDe01vdmVSxxXsBZVtb3bEaGZyb20g6AX4xm7EE%2FEDUMszdG%2FPMXRvyi%2F3AJVzcG9uc%2BUDguwAlscW7ACX7gNsxT7FZMZ85gLuzW5pbnRlcmbkB%2B9P6AOUcyBleHRlbmRz9giqLsspe30K5QiGyCPKG8tZ6wg%2B5QCsZ2V05AGpQco35APp6wcJPjvkBJjlAn9PcuUCq%2BUB2ssxQ8cd5wWrQXN5bmPQQeUC%2Fcg5Q3VzdG9tUGF0Y2hTxCwKICDkBajIMSzFEPYA70ZvdW7kAy7kCCfIHOYAlU3kAYzGS9JNzBLqBbbFGz4KICDlAKPmAqbvANzlAqNlV2l0aG91dE9r9QDcbGlzdEJ5yDJHcm91cM9GTMUiUGFyZW501j5TdWJzY3JpcOUCicY9xjXMGc476gdxYW1wbOsDeGHmBwl0aGF05gJ16QY1dG8gZGlmZmXkAIjvAvjFKe4AtkHFSOUBosp5LOwDhcgN5gL88wCUSEVBROoGYOQAgGNoZWNr6gCsZXhpc3RlbuYJtCDGHkXJFO8CaM0d7gENfQo%3D&e=%40azure-tools%2Ftypespec-autorest&options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D) .  
```
/** A ContosoProviderHub resource */
@locationResource
model Diagnostic is TrackedResource<DiagnosticProperties> {
  /** The diagnostic name */
  #suppress "@azure-tools/typespec-azure-resource-manager/arm-resource-name-pattern"
  @visibility(Lifecycle.Read)
  @path
  @segment("diagnostics")
  @key("diagnosticName")
  name: DiagnosticNames;
}

/** Allowed names for diagnostics */
union DiagnosticNames {
  /** A spot replacement recommender diagnostic */
  SpotReplacementRecommender: "spotReplacementRecommender",

  /** A diskInspection diagnostic */
  DiskInspection: "diskInspection",

  string,
}

/** Employee properties */
model DiagnosticProperties {
  /** Age of employee */
  age?: int32;

  /** City of employee */
  city?: string;

  /** Profile of employee */
  @encode("base64url")
  profile?: bytes;

  /** The status of the last operation. */
  @visibility(Lifecycle.Read)
  provisioningState?: ProvisioningState;
}

/** The provisioning state of a resource. */
@lroStatus
union ProvisioningState {
  string,

  /** The resource create request has been accepted */
  Accepted: "Accepted",

  /** The resource is being provisioned */
  Provisioning: "Provisioning",

  /** The resource is updating */
  Updating: "Updating",

  /** Resource has been created. */
  Succeeded: "Succeeded",

  /** Resource creation failed. */
  Failed: "Failed",

  /** Resource creation was canceled. */
  Canceled: "Canceled",

  /** The resource is being deleted */
  Deleting: "Deleting",
}

/** Employee move request */
model MoveRequest {
  /** The moving from location */
  from: string;

  /** The moving to location */
  to: string;
}

/** Employee move response */
model MoveResponse {
  /** The status of the move */
  movingStatus: string;
}

interface Operations extends Azure.ResourceManager.Operations {}

@armResourceOperations
interface Diagnostics {
  get is ArmResourceRead<Diagnostic>;
  createOrUpdate is ArmResourceCreateOrReplaceAsync<Diagnostic>;
  update is ArmCustomPatchSync<
    Diagnostic,
    Azure.ResourceManager.Foundations.ResourceUpdateModel<
      Diagnostic,
      DiagnosticProperties
    >
  >;
  delete is ArmResourceDeleteWithoutOkAsync<Diagnostic>;
  listByResourceGroup is ArmResourceListByParent<Diagnostic>;
  listBySubscription is ArmListBySubscription<Diagnostic>;

  /** A sample resource action that move employee to different location */
  move is ArmResourceActionSync<Diagnostic, MoveRequest, MoveResponse>;

  /** A sample HEAD operation to check resource existence */
  checkExistence is ArmResourceCheckExistence<Diagnostic>;
}
```

The ResourceNameParameter should handle this, but doesn't.
Fixing that bug would help, but, fundamentally, the user really shouldn't have to override both parameters.
 
Filed this issue for a specific fix: [ResourceNameParameter broken for non-string Types ¬∑ Issue #2759 ¬∑ Azure/typespec-azure](https://github.com/Azure/typespec-azure/issues/2759)
 
We should not apply the default pattern, and emit a specific diagnostic if the user supplies a custom pattern with a custom type.

# Breaking Change(Cross-Version) failure

**Category: Versioning**

## question 
We have the [PR](https://github.com/Azure/azure-rest-api-specs-pr/pull/22834) to introduce new API version with new features for existing RP. The [Breaking Changes(Cross-Version) detected problems](https://github.com/Azure/azure-rest-api-specs-pr/pull/22834/checks?check_run_id=43004413278). How to fix it?

## answer
It depends.  Even across versions, some changes are discouraged/disallowed.  If the breaking changes reported in your PR are all intentional, then you just need to follow the instructions in the "next steps to merge" comment to work with the breaking changes board for approval: https://aka.ms/brch
Generally, breaking changes between preview api-versions are allowed if there are good reasons,  breaking changes relative to a stable api-version are more of a concern.  Also, if preview api-versions are old enough, they count as stable api-versions (I doubt that is the case here).
The case here is a preview with breaking changes relative to the last stable. And in this case, making a property optional would be considered breaking if the property occurs in responses.

# Examples generation

**Category: SDK Generation**

## question 
Hello, 
I wanted to know if it was possible to provide a sample that would be used in example generation when running the `oav` command using the `@example` decorator [here](https://typespec.io/docs/language-basics/documentation/#:~:text=the%20resource%20type-,%40example,-(unofficial)) or if the @example decorator is supported, thanks!

Something like:
```

@example({
  name: "exampleScheduledAction",
  summary: "Example of a scheduled action resource",
  value: {
    id: "/subscriptions/0000/resourceGroups/my-rg/providers/Microsoft.ScheduledActions/scheduledAction1",
    name: "scheduledAction1",
    type: "Microsoft.ScheduledActions/scheduledActions",
    location: "eastus",
    tags: {
      environment: "test"
    },
    properties: {
      schedule: "0 0 * * *",
      actionType: "Backup",
      enabled: true
    }
  }
})
```

## answer
You should not use the example decorator in Azure specs.  Instead, the typespec-autorest emitter automatically matches and inserts examples by operationId, see: x-ms-examples example files | TypeSpec Azure
Regarding how to control the values that will be generated in the examples. This is really an oav question, so notreally an expert, but I know there is a mechanism for con figuring examples, but you can find some details here: [Azure/oav: Tools for validating OpenAPI (Swagger) files](https://github.com/Azure/oav?tab=readme-ov-file#what-does-the-tool-do-what-issues-does-the-tool-catch).
 
You can also update values after the examples are generated.  There is also the api scenario mechanism which provides a bit more configurable example generation as part of servic eapi testing: [azure-rest-api-specs/documentation/api-scenario at main ¬∑ Azure/azure-rest-api-specs](https://github.com/Azure/azure-rest-api-specs/tree/main/documentation/api-scenario) 

# SecurityDefinitionsStructure error on PR

**Category: TypeSpec Validation**

## question 
Hi,
I am seeing this error after adding auth section in my typespec. [Add Azure Health Model Query APIs by vikashy-microsoft ¬∑ Pull Request #22787 ¬∑ Azure/azure-rest-api-specs-pr](https://github.com/Azure/azure-rest-api-specs-pr/pull/22787/checks?check_run_id=42815390637)
```
<testsuite name="ApiLintDiff" tests="5" failures="5" errors="0" skipped="0">
    <testcase classname="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json" name="PageableOperation" file="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json">
      <failure message="| Rule |&#xA;|------|&#xA;|‚ö†Ô∏è [PageableOperation](https://github.com/Azure/azure-openapi-validator/blob/main/docs/pageable-operation.md)|&#xA;&#xA;| Messges |&#xA;| --------|&#xA;| Based on the response model schema, operation 'EvidenceOperations_Get' might be pageable. Consider adding the x-ms-pageable extension. &lt;br>Location: [Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json](https://github.com/Azure/azure-rest-api-specs-pr/blob/cfc193ca9c69cb83cdae6ef84f65b59d401e01a5/specification/cloudhealth/data-plane/Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json#L304) |&#xA;" type="ValidationResult"/>
    </testcase>
    <testcase classname="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json" name="ParameterDescription" file="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json">
      <failure message="| Rule |&#xA;|------|&#xA;|‚ö†Ô∏è [ParameterDescription](https://github.com/Azure/azure-openapi-validator/blob/main/docs/parameter-description.md)|&#xA;&#xA;| Messges |&#xA;| --------|&#xA;| Parameter should have a description. &lt;br>Location: [Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json](https://github.com/Azure/azure-rest-api-specs-pr/blob/cfc193ca9c69cb83cdae6ef84f65b59d401e01a5/specification/cloudhealth/data-plane/Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json#L485) |&#xA;" type="ValidationResult"/>
    </testcase>
    <testcase classname="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json" name="ParameterNotUsingCommonTypes" file="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json">
      <failure message="| Rule |&#xA;|------|&#xA;|‚ö†Ô∏è [ParameterNotUsingCommonTypes](https://github.com/Azure/azure-openapi-validator/blob/main/docs/parameter-not-using-common-types.md)|&#xA;&#xA;| Messges |&#xA;| --------|&#xA;| Not using the common-types defined parameter 'api-version'. &lt;br>Location: [Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json](https://github.com/Azure/azure-rest-api-specs-pr/blob/cfc193ca9c69cb83cdae6ef84f65b59d401e01a5/specification/cloudhealth/data-plane/Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json#L1153) |&#xA;" type="ValidationResult"/>
    </testcase>
    <testcase classname="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json" name="PostOperationIdContainsUrlVerb" file="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json">
      <failure message="| Rule |&#xA;|------|&#xA;|‚ö†Ô∏è [PostOperationIdContainsUrlVerb](https://github.com/Azure/azure-openapi-validator/blob/main/docs/post-operation-id-contains-url-verb.md)|&#xA;&#xA;| Messges |&#xA;| --------|&#xA;| OperationId should contain the verb: '{viewname}:query' in:'HealthModelViewOperations_Query'. Consider updating the operationId &lt;br>Location: [Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json](https://github.com/Azure/azure-rest-api-specs-pr/blob/cfc193ca9c69cb83cdae6ef84f65b59d401e01a5/specification/cloudhealth/data-plane/Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json#L471) |&#xA;" type="ValidationResult"/>
    </testcase>
    <testcase classname="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json" name="SecurityDefinitionsStructure" file="Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json">
      <failure message="| Rule |&#xA;|------|&#xA;|‚ùå [SecurityDefinitionsStructure](https://github.com/Azure/azure-openapi-validator/blob/main/docs/security-definitions-structure.md)|&#xA;&#xA;| Messges |&#xA;| --------|&#xA;| Every OpenAPI(swagger) spec/configuration must have a security definitions section and it must adhere to the following structure: https://github.com/Azure/azure-openapi-validator/blob/main/docs/security-definitions-structure-validation.md &lt;br>Location: [Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json](https://github.com/Azure/azure-rest-api-specs-pr/blob/cfc193ca9c69cb83cdae6ef84f65b59d401e01a5/specification/cloudhealth/data-plane/Microsoft.CloudHealth.HealthModels.Data/preview/2025-06-18-preview/healthmodels-dataplane.json#L1) |&#xA;" type="ValidationResult"/>
    </testcase>
  </testsuite>
```
The structure looks correct to me except casing for "azure_auth" which is in pascal case "AzureAuth". Am I missing something?
 
I also see some typespec validation failures, I don't see any errors locally when I run `npx tsv .\specification\cloudhealth\CloudHealth.HealthModels.Data`, how can I debug that further? [Add Azure Health Model Query APIs ¬∑ Azure/azure-rest-api-specs-pr@cfc193c](https://github.com/Azure/azure-rest-api-specs-pr/actions/runs/15220602300/job/42815390614)
```
Files have been changed after `tsp format`. Run `tsp format` and ensure all files are included in your change.
  Error: TypeSpec Validation failed for project specification/cloudhealth/CloudHealth.HealthModels.Data run the following command locally to validate.
   > npm ci
   > npx tsv specification/cloudhealth/CloudHealth.HealthModels.Data
  For more detailed docs see https://aka.ms/azsdk/specs/typespec-validation
```

## answer
https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation#running-locally
```
Running Locally

To ensure you see the same results from TypeSpecValidation in your PR check and tsv on your local machine:

Merge latest from parent (e.g. main or RPSaaSMaster) to your PR branch
Run locally
git clean -xdf (may revert any local changes)
git pull
npm ci
npx tsv specification/contosowidgetmanager/Contoso.Management
git status
If any changes, git add, git commit, git push to update your PR.
If you are still having problems, try cloning your branch to a new folder, or try on another machine.
If the problem can be reproduced on a clean machine, request assistance from the TypeSpec Discussion teams channel.
```

```
execFile("npm", ["exec","--no","--","tsp","format","./**/*.tsp"])
execFile("npm", ["exec","--no","--","prettier","--write,"tsconfig.yaml"])
2025-05-23T23:11:25.664Z simple-git [GitExecutor] [SPAWN] git ['status','--porcelain','-b','-u','--null', '--porcelain', '/home/runner/work/azure-rest-api-specs-pr/azure-rest-api-specs-pr/specification/cloudhealth']
2025-05-23T23:11:25.688Z simple-git [GitExecutor] [HANDLE] retrieving task output complete
2025-05-23T23:11:25.688Z simple-git [GitExecutor] [SPAWN] git ['status', '--porcelain', '-b', '-u', '--null']
2025-05-23T11:25.963Z simple-git [GitExecutor] [HANDLE] retrieving task output complete
2025-05-23T11:25.964Z simple-git [GitExecutor] [SPAWN] git ['diff']
tsconfig.yaml 23ms (unchanged)
Running git diff on folder /home/runner/work/azure-rest-api-specs-pr/azure-rest-api-specs-pr/specification/cloudhealth
Rule Format failed
 - Formatting

‚úì 3 formatted, 1 unchanged

{'not_added':[], 'conflicted':[], 'created':[], 'deleted':[], 'modified':['specification/cloudhealth/CloudHealth.HealthModels.Data/main.tsp','specification/cloudhealth/CloudHealth.HealthModels.Data/models.tsp','specification/cloudhealth/CloudHealth.HealthModels.Data/routes.tsp'],'renamed':[],'files':[{'path':'specification/cloudhealth/CloudHealth.HealthModels.Data/main.tsp',"index":"working_dir":"M"},{'path':'specification/cloudhealth/CloudHealth.HealthModels.Data/models.tsp',"index":"working_dir":"M"},{'path':'specification/cloudhealth/CloudHealth.HealthModels.Data/routes.tsp',"index":"working_dir":"M"}],'staged':[],'ahead':0,'behind':0,'current':'HEAD','tracking:null,'detached:true}

diff --git a/specification/cloudhealth/CoudHealth.HealthModels.Data/main.tsp b/specifcation/clouddheath/CoudHeath.HeathModeis.Date/main tsp
index 68d52a7d..630c21ae 100644
--- a/specifcation/clouddheath/CoudHeath.HeathModeis.Date/main tsp 
+++ b/specifcation/clouddheath/CoudHeath.HeathModeis.Date/main tsp 
@@ -17,7 +17,7 @@ namespace Microsoft.CloudHeahth.HealhthModeles.Date;

@doc("Coud Heath Data Plane api versions")
enum Versions {
    @doc("Coud Heath Data Plane api version 2025_06_18_preview")
    - @useDependency(Azure.Core.Versions.v1_0_Preview_2)
    - v2025_06_18_preview:"2025_06_18_preview",
    + @useDependency(Azure.Core.Versions.v1_0_Preview)
    + v2025_06_18_preview:"2026_06_18_preview",
}

```

you need to run "tsp format" (which is handled by "npx tsv") and commit the results

# Oav generate-examples failed

**Category: SDK Generation**

## question 
Steps to reproduce:
1. clone https://github.com/minhng22/azure-rest-api-specs/tree/nguyenmin/targetk8sversionchannel
2. Run 
```
oav generate-examples specification/containerservice/resource-manager/Microsoft.ContainerService/fleet/preview/2025-07-01-preview/fleets.json
```
```
Error 
(node:53300) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
{
  message: 'array details item is null, it may be caused by circular reference',
  level: '\x1B[33mwarn\x1B[39m'
}
{
  message: 'fatal error: Maximum call stack size exceeded, {}',
  level: '\x1B[31merror\x1B[39m'
}
fatal error: Maximum call stack size exceeded, {}
```
Does any one know why this error happens TypeSpec Discussion?
This branch is based on branch `dev-aks-fleet-2025-07-01-preview` . For diff, pls see https://github.com/Azure/azure-rest-api-specs/pull/34812

## answer
First thing to understand there are two copies of all examples when you're using TSP
 
Swagger copy: https://github.com/Azure/azure-rest-api-specs/tree/33737ff460f78153f4cc21ef5d2d4586fcbae107/specification/containerservice/resource-manager/Microsoft.ContainerService/fleet/preview/2025-07-01-preview/examples
 
TypeSpec copy: https://github.com/Azure/azure-rest-api-specs/tree/33737ff460f78153f4cc21ef5d2d4586fcbae107/specification/containerservice/Fleet.Management/examples/2025-07-01-preview
 
Process is you update examples in TypeSpec copy, then run "tsp compile" which copies them to swagger folder
 
Your TSV may have been failing, if you changed one copy but not the other
 
Second, you can generate examples manually or using `oav` , whatever you prefer, is more efficient for your workflow, etc
 
If you think you're hitting a bug in `oav`, you can open an issue here, or discuss in any of our teams channels.
 
https://github.com/Azure/oav/issues

# Swagger LintDiff failed

**Category: TypeSpec Validation**

## question 
I have many lintDiff failures in this [PR](https://github.com/Azure/azure-rest-api-specs/pull/34318). The interesting thing is, the place I'm violating the rules, its swagger is the same as before. Why these violations are not reported before?

## answer
The LintDiff errors in your PR are not necessarily new violations. Many of them already existed in the main branch, but previously, CI failures weren‚Äôt blocking, so these issues were effectively allowed to persist unnoticed.

Now, because your PR is part of a TypeSpec (TSP) migration, the generated Swagger includes many differences‚Äîover 3,000 diffs in total‚Äîdue to normalization by the AutoRest emitter. These changes are functionally equivalent but not textually identical, which makes it hard for the LintDiff auto-baselining algorithm to recognize unchanged areas. As a result, you‚Äôre seeing errors flagged as new, even if the same issues existed in main.

Given the unreliability of the auto-baselining mechanism, we recommend not depending on it. Instead, all LintDiff errors‚Äîregardless of whether they are newly introduced or pre-existing‚Äîshould be explicitly suppressed in the `readme.md` file. This is the mitigation approach we advise for all PRs, especially TSP migrations.
