# Versioning question with new GA after preview

## question 
I opened this [PR](https://github.com/Azure/azure-rest-api-specs/pull/37879) and trying to add a new GA api-version to the type spec. main.tsp
 
First thing I realized that we missed`@previewVersion` decorator on the preview version and it needs to go to the last place of the Versions enum.  I made those changes on my local, it seems fix the issue I had on preview version change available on my GA changes.
 
However, with this change the problem now is my GA changes are leaking to the preview version openapi.json.  My question here now is, how do we define this GA version later than a preview version properly?  They are basically for different features.
```
enum Versions {
  v2025_06_01: "2025-06-01",
  v2025_12_01: "2025-12-01",
  @previewVersion
  v2025_09_01_preview: "2025-09-01-preview",
}
```

## answer
You should not use the @previewVersion decorator with ARM APIs. Versions in the Versions enum need to be in increasing order by date. If a stable version happens after a preview, then you will need to appropriately mark APIs that are not in the stable version.
To handle APIs that exist in preview but not in the stable version, you model the API changes using versioning decorators. Mark removed elements with @removed(Version), added elements with @added(Version), and renamed or changed elements with the appropriate versioning decorators.
You are decorating diffs in the API, not versions in the enum. For example, if version 2025-06-01-preview is the first version, and you have a property 'bar' in model "Foo' that is in preview, but not part of the new stable version 2025-10-01, then it would be marked with the @removed decorator:
```
model Foo {
  @removed(Versions.v2025-10-01)
  bar?: string;
  ...
}
```
If later you have another preview version, you will need to add the API back for that version, so the version history will be reflected in the decorations.
When you add a new preview API in the future, you will replace the existing preview with the new one, and the TypeSpec definition will only keep one active preview version at a time.

# azure-rest-api-specs CI Swagger ModelValidation ：xxx is not a valid JSON Schema

## question 
This is my [PR](https://github.com/Azure/azure-rest-api-specs/pull/37995/checks). And I got many errors :　xxx  is not a valid JSON Schema　[link](https://github.com/Azure/azure-rest-api-specs/actions/runs/18548447064/job/52870861336?pr=37995):
```
Error getting examples for specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/ChaosFaultEnableDisable.json: "/home/runner/work/azure-rest-api-specs/azure-rest-api-specs/specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/ChaosFaultEnableDisable.json" is not a valid JSON Schema
Error getting examples for specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/ChaosFaultGet.json: "/home/runner/work/azure-rest-api-specs/azure-rest-api-specs/specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/ChaosFaultGet.json" is not a valid JSON Schema
Error getting examples for specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/ChaosFaultList.json: "/home/runner/work/azure-rest-api-specs/azure-rest-api-specs/specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/ChaosFaultList.json" is not a valid JSON Schema
Error getting examples for specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/CosmosDBCassandraKeyspaceCreateUpdate.json: "/home/runner/work/azure-rest-api-specs/azure-rest-api-specs/specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/CosmosDBCassandraKeyspaceCreateUpdate.json" is not a valid JSON Schema
Error getting examples for specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/CosmosDBCassandraKeyspaceDelete.json: "/home/runner/work/azure-rest-api-specs/azure-rest-api-specs/specification/cosmos-db/CosmosDB.Management/examples/2025-05-01-preview/CosmosDBCassandraKeyspaceDelete.json" is not a valid JSON Schema
...
```
 
And I am sure that these are valid  JSON. 
Besides, the latest merged [PR](https://github.com/Azure/azure-rest-api-specs/pull/35785) did not have the same problem.
 
Thanks for you help！

## answer
The errors you saw in ModelValidation appear to be related to example values that the tool claims are not valid UUIDs or ARM IDs, which you should verify. There was also mention of a missing example and potential file name capitalization issues, but those were not confirmed in your case.
One issue with your PR was that LintDiff crashed due to an out-of-memory error, which was fixed by increasing max-old-space-size from 8GB to 16GB.
Regarding the repeated “is not a valid JSON Schema” messages, this seems to be a harmless bug in the new oav-runner and spec-model code. The problem is triggered because the spec has nested folders under examples. ModelValidation historically only validated examples in the top-level examples folder and ignored nested ones.
Going forward, we need to decide whether to support nested examples or block them. Since nested examples already exist in main, banning them would be difficult. The current plan is to update ModelValidation to handle nested examples.